<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Interactive Medication Timeline | ShotziOS Educational Platform</title>
    <style>
      /* Base styles optimized for dyslexia */
      :root {
        --bg-color: #0f0f1a;
        --text-color: #e6e6ff;
        --accent-color: #3498db;
        --accent-dark: #2980b9;
        --accent-light: #5dade2;
        --card-bg: #1a1a2e;
        --nav-bg: #141428;
        --success-color: #27ae60;
        --warning-color: #e67e22;
        --danger-color: #e74c3c;
        --neutral-color: #7f8c8d;
        --inactive-color: #7f8c8d;
        --med-color-1: #9b59b6;
        --med-color-2: #e74c3c;
        --med-color-3: #f1c40f;
        --med-color-4: #2ecc71;
        --header-height: 64px;
        --sidebar-width: 260px;
        --border-radius: 8px;
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        font-family: 'Open Dyslexic', 'Comic Sans MS', Arial, sans-serif;
        background-color: var(--bg-color);
        color: var(--text-color);
        line-height: 1.6;
        letter-spacing: 0.025em;
        word-spacing: 0.1em;
        padding-bottom: 60px;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
      }

      /* Header styles */
      header {
        background-color: var(--nav-bg);
        height: var(--header-height);
        border-bottom: 2px solid var(--accent-color);
        position: sticky;
        top: 0;
        z-index: 100;
      }

      .header-content {
        display: flex;
        align-items: center;
        justify-content: space-between;
        height: 100%;
      }

      .logo {
        display: flex;
        align-items: center;
        font-size: 1.5rem;
        font-weight: bold;
        color: var(--accent-color);
      }

      .logo img {
        height: 40px;
        margin-right: 10px;
      }

      .avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background-color: var(--accent-color);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
      }

      /* Navigation */
      nav {
        background-color: var(--nav-bg);
        padding: 10px 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .nav-links {
        display: flex;
        gap: 20px;
        list-style: none;
        overflow-x: auto;
        padding: 0 20px;
      }

      .nav-links li a {
        color: var(--text-color);
        text-decoration: none;
        padding: 5px 10px;
        border-radius: var(--border-radius);
        transition: all 0.3s ease;
        white-space: nowrap;
        font-weight: 500;
      }

      .nav-links li a:hover,
      .nav-links li a.active {
        background-color: var(--accent-color);
        color: white;
      }

      /* Main content area */
      main {
        padding: 20px 0;
      }

      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        color: var(--accent-color);
        margin-bottom: 15px;
        margin-top: 30px;
        font-weight: 600;
      }

      h1 {
        font-size: 2rem;
        border-bottom: 2px solid var(--accent-color);
        padding-bottom: 10px;
        margin-bottom: 20px;
      }

      h2 {
        font-size: 1.5rem;
      }

      h3 {
        font-size: 1.25rem;
      }

      p {
        margin-bottom: 15px;
      }

      /* Card layouts */
      .card {
        background-color: var(--card-bg);
        border-radius: var(--border-radius);
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
        overflow: hidden;
        border-left: 4px solid var(--accent-color);
      }

      .card-header {
        padding: 15px 20px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        font-weight: bold;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .card-content {
        padding: 20px;
      }

      /* Buttons */
      .btn {
        display: inline-block;
        background-color: var(--accent-color);
        color: white;
        padding: 10px 15px;
        border-radius: var(--border-radius);
        text-decoration: none;
        border: none;
        cursor: pointer;
        font-family: inherit;
        font-size: 1rem;
        transition: background-color 0.3s ease;
      }

      .btn:hover {
        background-color: var(--accent-dark);
      }

      .btn-success {
        background-color: var(--success-color);
      }

      .btn-success:hover {
        background-color: #219952;
      }

      .btn-warning {
        background-color: var(--warning-color);
      }

      .btn-warning:hover {
        background-color: #d35400;
      }

      .btn-danger {
        background-color: var(--danger-color);
      }

      .btn-danger:hover {
        background-color: #c0392b;
      }

      .btn-outlined {
        background-color: transparent;
        border: 2px solid var(--accent-color);
        color: var(--accent-color);
      }

      .btn-outlined:hover {
        background-color: var(--accent-color);
        color: white;
      }

      .btn-icon {
        background-color: rgba(255, 255, 255, 0.1);
        border: none;
        border-radius: 50%;
        width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .btn-icon:hover {
        background-color: rgba(255, 255, 255, 0.2);
      }

      /* Grid layouts */
      .grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      /* Dyslexia-specific styles */
      .dyslexia-friendly-text {
        font-size: 1.05rem;
        line-height: 1.8;
        word-spacing: 0.15em;
        letter-spacing: 0.04em;
      }

      /* Features specialized for dyslexia */
      .reading-guide {
        background-color: rgba(52, 152, 219, 0.2);
        padding: 2px;
        border-radius: 4px;
        cursor: pointer;
        position: relative;
      }

      .reading-guide::after {
        content: 'üëÅÔ∏è';
        position: absolute;
        right: -20px;
        top: 50%;
        transform: translateY(-50%);
        font-size: 14px;
        opacity: 0.7;
      }

      .text-to-speech-btn {
        background-color: var(--accent-light);
        color: white;
        border: none;
        border-radius: 50%;
        width: 32px;
        height: 32px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        margin-left: 10px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .text-to-speech-btn:hover {
        background-color: var(--accent-color);
        transform: scale(1.1);
      }

      /* Form elements */
      .form-group {
        margin-bottom: 20px;
      }

      .form-label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
      }

      .form-control {
        width: 100%;
        padding: 10px 15px;
        background-color: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: var(--border-radius);
        color: var(--text-color);
        font-family: inherit;
        font-size: 1rem;
        transition: all 0.3s ease;
      }

      .form-control:focus {
        outline: none;
        border-color: var(--accent-color);
        box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.3);
      }

      select.form-control {
        appearance: none;
        background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23e6e6ff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: right 10px center;
        background-size: 16px;
        padding-right: 40px;
      }

      /* Toggle Switch */
      .toggle-switch {
        position: relative;
        display: inline-block;
        width: 50px;
        height: 24px;
      }

      .toggle-switch input {
        opacity: 0;
        width: 0;
        height: 0;
      }

      .toggle-slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(255, 255, 255, 0.1);
        transition: 0.4s;
        border-radius: 34px;
      }

      .toggle-slider:before {
        position: absolute;
        content: '';
        height: 16px;
        width: 16px;
        left: 4px;
        bottom: 4px;
        background-color: white;
        transition: 0.4s;
        border-radius: 50%;
      }

      input:checked + .toggle-slider {
        background-color: var(--accent-color);
      }

      input:checked + .toggle-slider:before {
        transform: translateX(26px);
      }

      /* Tab panel styles */
      .tab-container {
        margin-bottom: 30px;
      }

      .tab-buttons {
        display: flex;
        border-bottom: 2px solid var(--accent-color);
        margin-bottom: 20px;
      }

      .tab-btn {
        padding: 10px 20px;
        background-color: transparent;
        border: none;
        color: var(--text-color);
        cursor: pointer;
        font-family: inherit;
        font-size: 1rem;
        font-weight: 600;
        transition: all 0.3s ease;
        border-bottom: 3px solid transparent;
        margin-bottom: -2px;
      }

      .tab-btn:hover {
        color: var(--accent-color);
      }

      .tab-btn.active {
        color: var(--accent-color);
        border-bottom-color: var(--accent-color);
      }

      .tab-content {
        display: none;
      }

      .tab-content.active {
        display: block;
      }

      /* Timeline specific styles */
      .timeline-container {
        position: relative;
        width: 100%;
        margin: 20px 0;
        overflow-x: hidden;
      }

      .timeline-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
      }

      .timeline-controls {
        display: flex;
        gap: 10px;
        align-items: center;
      }

      .timeline {
        position: relative;
        height: 300px;
        overflow-x: auto;
        padding: 20px 0;
      }

      .timeline-ruler {
        position: absolute;
        left: 0;
        right: 0;
        top: 150px;
        height: 2px;
        background-color: rgba(255, 255, 255, 0.2);
        z-index: 1;
      }

      .timeline-tick {
        position: absolute;
        top: 140px;
        width: 1px;
        height: 10px;
        background-color: rgba(255, 255, 255, 0.2);
        transform: translateX(-50%);
      }

      .timeline-tick-label {
        position: absolute;
        top: 155px;
        font-size: 0.8rem;
        transform: translateX(-50%);
        color: rgba(255, 255, 255, 0.5);
      }

      .timeline-week-label {
        position: absolute;
        top: 110px;
        font-size: 0.9rem;
        transform: translateX(-50%);
        color: rgba(255, 255, 255, 0.8);
        font-weight: bold;
      }

      .timeline-events {
        position: relative;
        width: 3000px; /* Wide enough for a month of events */
        height: 100%;
      }

      .timeline-event {
        position: absolute;
        padding: 8px;
        border-radius: var(--border-radius);
        transform: translateX(-50%);
        color: white;
        font-size: 0.8rem;
        text-align: center;
        cursor: pointer;
        z-index: 2;
        transition: all 0.3s ease;
      }

      .timeline-event:hover {
        transform: translateX(-50%) translateY(-5px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        z-index: 3;
      }

      .event-medication {
        background-color: var(--warning-color);
        top: 40px;
        width: 100px;
      }

      .event-academic {
        background-color: var(--success-color);
        top: 200px;
        width: 120px;
      }

      .event-behavioral {
        background-color: var(--accent-color);
        top: 80px;
        width: 110px;
      }

      .event-missed {
        background-color: var(--danger-color);
        top: 40px;
        width: 100px;
        border: 2px dashed white;
      }

      .event-observation {
        background-color: var(--neutral-color);
        top: 240px;
        width: 130px;
      }

      .timeline-today-marker {
        position: absolute;
        top: 20px;
        bottom: 20px;
        width: 2px;
        background-color: var(--danger-color);
        z-index: 2;
        transform: translateX(-50%);
      }

      .timeline-today-marker::before {
        content: 'Today';
        position: absolute;
        top: -20px;
        left: 50%;
        transform: translateX(-50%);
        background-color: var(--danger-color);
        padding: 2px 8px;
        border-radius: 4px;
        font-size: 0.8rem;
      }

      .timeline-connection {
        position: absolute;
        background-color: rgba(255, 255, 255, 0.3);
        height: 2px;
        z-index: 1;
        top: 150px;
      }

      /* Timeline zoom controls */
      .zoom-controls {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 15px;
      }

      .zoom-slider {
        width: 150px;
        height: 8px;
        border-radius: 4px;
        background-color: rgba(255, 255, 255, 0.1);
        outline: none;
        -webkit-appearance: none;
      }

      .zoom-slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        width: 16px;
        height: 16px;
        border-radius: 50%;
        background-color: var(--accent-color);
        cursor: pointer;
      }

      /* Legend */
      .timeline-legend {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        margin-top: 20px;
        margin-bottom: 30px;
      }

      .legend-item {
        display: flex;
        align-items: center;
        font-size: 0.9rem;
      }

      .legend-color {
        width: 16px;
        height: 16px;
        border-radius: 4px;
        margin-right: 8px;
      }

      /* Event detail panel */
      .event-detail-panel {
        background-color: var(--card-bg);
        border-radius: var(--border-radius);
        padding: 20px;
        margin-top: 30px;
        display: none;
      }

      .event-detail-header {
        display: flex;
        justify-content: space-between;
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .event-detail-title {
        font-weight: bold;
        font-size: 1.2rem;
        color: var(--accent-color);
      }

      /* Medication correlation visualization */
      .correlation-chart {
        height: 300px;
        margin: 30px 0;
        position: relative;
        background-color: var(--card-bg);
        border-radius: var(--border-radius);
        padding: 20px;
      }

      .correlation-axis {
        position: absolute;
        background-color: rgba(255, 255, 255, 0.2);
      }

      .correlation-axis.x-axis {
        left: 50px;
        right: 20px;
        bottom: 50px;
        height: 1px;
      }

      .correlation-axis.y-axis {
        left: 50px;
        top: 20px;
        bottom: 50px;
        width: 1px;
      }

      .correlation-label {
        position: absolute;
        font-size: 0.8rem;
        color: rgba(255, 255, 255, 0.7);
      }

      .correlation-point {
        position: absolute;
        width: 10px;
        height: 10px;
        border-radius: 50%;
        transform: translate(-50%, -50%);
        cursor: pointer;
      }

      .correlation-tooltip {
        position: absolute;
        background-color: var(--card-bg);
        padding: 8px 12px;
        border-radius: var(--border-radius);
        font-size: 0.8rem;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        z-index: 10;
        pointer-events: none;
        opacity: 0;
        transition: opacity 0.2s ease;
      }

      /* Filter panel */
      .filter-panel {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        margin-top: 15px;
        margin-bottom: 15px;
      }

      .filter-option {
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .filter-label {
        font-size: 0.9rem;
      }

      /* Responsive styles */
      @media (max-width: 768px) {
        .container {
          padding: 0 15px;
        }

        .timeline-header {
          flex-direction: column;
          align-items: flex-start;
          gap: 15px;
        }

        .timeline-legend {
          flex-direction: column;
          align-items: flex-start;
        }

        .zoom-controls {
          width: 100%;
        }

        .zoom-slider {
          flex-grow: 1;
        }
      }

      /* Help character bubble */
      .help-character {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background-color: var(--accent-color);
        width: 60px;
        height: 60px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2rem;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        cursor: pointer;
        z-index: 100;
        transition: all 0.3s ease;
      }

      .help-character:hover {
        transform: scale(1.1);
      }

      .help-panel {
        position: fixed;
        bottom: 90px;
        right: 20px;
        width: 300px;
        background-color: var(--card-bg);
        border-radius: var(--border-radius);
        padding: 15px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        z-index: 100;
        transition: all 0.3s ease;
        opacity: 0;
        visibility: hidden;
        transform: translateY(20px);
      }

      .help-panel.active {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      .help-panel-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
        padding-bottom: 10px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .help-character-name {
        font-weight: bold;
        color: var(--accent-color);
      }

      .help-close {
        background: none;
        border: none;
        color: var(--text-color);
        cursor: pointer;
        font-size: 1.2rem;
      }

      .help-message {
        margin-bottom: 15px;
      }

      .help-options {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .help-option {
        padding: 8px 12px;
        background-color: rgba(52, 152, 219, 0.1);
        border-radius: var(--border-radius);
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .help-option:hover {
        background-color: rgba(52, 152, 219, 0.3);
      }
    </style>
  </head>
  <body>
    <header>
      <div class="container">
        <div class="header-content">
          <div class="logo">
            <img src="/logo.png" alt="ShotziOS Logo" />
            <span>ShotziOS Educational Platform</span>
          </div>
          <div class="avatar">S</div>
        </div>
      </div>
    </header>

    <nav>
      <div class="container">
        <ul class="nav-links">
          <li><a href="/dashboard">Dashboard</a></li>
          <li><a href="/superhero-school">Superhero School</a></li>
          <li><a href="/superhero-school/dyslexia-learning">Dyslexia Super-Learning</a></li>
          <li><a href="/superhero-school/adaptive-learning">AI Adaptive Learning</a></li>
          <li><a href="/superhero-school/gpa-calculator">GPA Calculator</a></li>
          <li><a href="/superhero-school/medication-tracker">Medication Tracker</a></li>
          <li>
            <a href="/superhero-school/medication-timeline" class="active">Medication Timeline</a>
          </li>
          <li><a href="/superhero-school/medical-vault">Medical Vault</a></li>
        </ul>
      </div>
    </nav>

    <main class="container">
      <h1>Interactive Medication Timeline</h1>

      <div class="card">
        <div class="card-header">
          <span>Medication and Academic Performance Timeline</span>
          <button class="text-to-speech-btn" title="Read aloud">üîä</button>
        </div>
        <div class="card-content dyslexia-friendly-text">
          <p>
            This interactive visualization allows you to explore the relationship between
            <span class="reading-guide">medication timing</span>,
            <span class="reading-guide">dosage patterns</span>, and
            <span class="reading-guide">academic performance</span> over time. By visualizing these
            connections, you can identify optimal medication schedules and their impact on learning
            outcomes.
          </p>

          <p>
            The timeline displays medication administration, academic assessments, behavioral
            observations, and other relevant events on a chronological timeline, making it easier to
            spot patterns and correlations.
          </p>
        </div>
      </div>

      <div class="form-group">
        <label class="form-label" for="student-select">Select Student:</label>
        <select class="form-control" id="student-select">
          <option value="">Select a student</option>
          <option value="1" selected>Alex Bronson (Grade 3)</option>
          <option value="2">Jamie Torres (Grade 7)</option>
          <option value="3">Sam Liu (Grade 10)</option>
        </select>
      </div>

      <div class="form-group">
        <label class="form-label" for="date-range">Time Period:</label>
        <select class="form-control" id="date-range">
          <option value="7">Past 7 Days</option>
          <option value="14" selected>Past 14 Days</option>
          <option value="30">Past 30 Days</option>
          <option value="90">Past 90 Days</option>
        </select>
      </div>

      <div class="filter-panel">
        <div class="filter-option">
          <label class="toggle-switch">
            <input type="checkbox" checked id="show-medication" />
            <span class="toggle-slider"></span>
          </label>
          <span class="filter-label">Medication Events</span>
        </div>

        <div class="filter-option">
          <label class="toggle-switch">
            <input type="checkbox" checked id="show-academic" />
            <span class="toggle-slider"></span>
          </label>
          <span class="filter-label">Academic Assessments</span>
        </div>

        <div class="filter-option">
          <label class="toggle-switch">
            <input type="checkbox" checked id="show-behavioral" />
            <span class="toggle-slider"></span>
          </label>
          <span class="filter-label">Behavioral Observations</span>
        </div>

        <div class="filter-option">
          <label class="toggle-switch">
            <input type="checkbox" checked id="show-missed" />
            <span class="toggle-slider"></span>
          </label>
          <span class="filter-label">Missed Doses</span>
        </div>

        <div class="filter-option">
          <label class="toggle-switch">
            <input type="checkbox" checked id="show-observations" />
            <span class="toggle-slider"></span>
          </label>
          <span class="filter-label">Parent/Teacher Observations</span>
        </div>
      </div>

      <div class="zoom-controls">
        <button class="btn-icon" id="zoom-out">‚àí</button>
        <input type="range" min="1" max="5" value="3" class="zoom-slider" id="zoom-level" />
        <button class="btn-icon" id="zoom-in">+</button>
        <span style="margin-left: 10px; font-size: 0.9rem" id="zoom-label">View: 2 weeks</span>
      </div>

      <div class="timeline-container">
        <div class="timeline-header">
          <h3>April 2025 Timeline</h3>

          <div class="timeline-controls">
            <button class="btn-icon" id="move-left">‚óÄ</button>
            <button class="btn" id="go-to-today">Today</button>
            <button class="btn-icon" id="move-right">‚ñ∂</button>
          </div>
        </div>

        <div class="timeline">
          <div class="timeline-ruler"></div>
          <div class="timeline-events" id="timeline-events">
            <!-- Timeline events will be dynamically generated here -->
          </div>
          <div class="timeline-today-marker" style="left: 1500px"></div>
        </div>
      </div>

      <div class="timeline-legend">
        <div class="legend-item">
          <div class="legend-color" style="background-color: var(--warning-color)"></div>
          <span>Medication Administration</span>
        </div>

        <div class="legend-item">
          <div class="legend-color" style="background-color: var(--success-color)"></div>
          <span>Academic Assessment</span>
        </div>

        <div class="legend-item">
          <div class="legend-color" style="background-color: var(--accent-color)"></div>
          <span>Behavioral Observation</span>
        </div>

        <div class="legend-item">
          <div
            class="legend-color"
            style="background-color: var(--danger-color); border: 1px dashed white"
          ></div>
          <span>Missed Dose</span>
        </div>

        <div class="legend-item">
          <div class="legend-color" style="background-color: var(--neutral-color)"></div>
          <span>Parent/Teacher Observation</span>
        </div>
      </div>

      <div class="event-detail-panel" id="event-detail-panel">
        <div class="event-detail-header">
          <div class="event-detail-title">Adderall XR 10mg</div>
          <button class="btn-icon" id="close-detail-panel">‚úï</button>
        </div>

        <div class="event-detail-content">
          <div class="dyslexia-friendly-text">
            <p><strong>Date & Time:</strong> April 10, 2025, 7:30 AM</p>
            <p><strong>Medication:</strong> Adderall XR 10mg</p>
            <p><strong>Administered By:</strong> Maria Bronson (Parent)</p>
            <p><strong>Notes:</strong> Taken with breakfast. No side effects reported.</p>

            <h4 style="margin-top: 20px">Associated Observations</h4>
            <ul>
              <li>Reading group participation: High engagement (10:30 AM)</li>
              <li>Teacher noted improved focus during math lesson (1:15 PM)</li>
            </ul>

            <h4 style="margin-top: 20px">Next Day Effects</h4>
            <p>No residual effects noted the following morning.</p>
          </div>

          <div style="display: flex; gap: 10px; margin-top: 20px">
            <button class="btn btn-outlined">Edit Details</button>
            <button class="btn btn-outlined">Add Observation</button>
          </div>
        </div>
      </div>

      <div class="card" style="margin-top: 30px">
        <div class="card-header">
          <span>Medication Performance Correlation</span>
        </div>
        <div class="card-content">
          <p class="dyslexia-friendly-text">
            This visualization shows the correlation between medication timing and academic
            performance metrics. Each point represents a day, with the X-axis showing the time
            medication was administered and the Y-axis showing the performance level.
          </p>

          <div class="form-group">
            <label class="form-label" for="performance-metric">Performance Metric:</label>
            <select class="form-control" id="performance-metric">
              <option value="focus">Focus Duration</option>
              <option value="engagement">Classroom Engagement</option>
              <option value="completion">Task Completion Rate</option>
              <option value="assessment">Assessment Scores</option>
              <option value="combined">Combined Performance Index</option>
            </select>
          </div>

          <div class="correlation-chart" id="correlation-chart">
            <div class="correlation-axis x-axis"></div>
            <div class="correlation-axis y-axis"></div>

            <!-- X-axis labels -->
            <div
              class="correlation-label"
              style="bottom: 20px; left: 50px; transform: translateX(-50%)"
            >
              6:30 AM
            </div>
            <div
              class="correlation-label"
              style="bottom: 20px; left: 175px; transform: translateX(-50%)"
            >
              7:00 AM
            </div>
            <div
              class="correlation-label"
              style="bottom: 20px; left: 300px; transform: translateX(-50%)"
            >
              7:30 AM
            </div>
            <div
              class="correlation-label"
              style="bottom: 20px; left: 425px; transform: translateX(-50%)"
            >
              8:00 AM
            </div>
            <div
              class="correlation-label"
              style="bottom: 20px; left: 550px; transform: translateX(-50%)"
            >
              8:30 AM
            </div>

            <!-- Y-axis labels -->
            <div
              class="correlation-label"
              style="left: 20px; top: 50px; transform: translateY(-50%)"
            >
              High
            </div>
            <div
              class="correlation-label"
              style="left: 20px; top: 150px; transform: translateY(-50%)"
            >
              Medium
            </div>
            <div
              class="correlation-label"
              style="left: 20px; top: 250px; transform: translateY(-50%)"
            >
              Low
            </div>

            <!-- Axis titles -->
            <div class="correlation-label" style="bottom: 0; left: 300px; font-weight: bold">
              Medication Time
            </div>
            <div
              class="correlation-label"
              style="
                left: 0;
                top: 150px;
                transform: rotate(-90deg) translateX(-50%);
                transform-origin: left;
                font-weight: bold;
              "
            >
              Performance Level
            </div>

            <!-- Correlation points will be dynamically generated here -->
          </div>

          <div class="correlation-tooltip" id="correlation-tooltip"></div>

          <div style="margin-top: 20px">
            <button class="btn" id="analyze-correlation-btn">Analyze Patterns</button>
            <button class="btn btn-outlined" style="margin-left: 10px">Download Report</button>
          </div>
        </div>
      </div>

      <div class="card" style="margin-top: 30px; display: none" id="ai-analysis-panel">
        <div class="card-header">
          <span>AI-Enhanced Pattern Analysis</span>
        </div>
        <div class="card-content">
          <div class="dyslexia-friendly-text">
            <h4>Key Findings</h4>
            <ul>
              <li>
                <strong>Optimal Timing:</strong> Medication administered between 7:15-7:45 AM
                correlates with 28% higher focus duration compared to earlier or later
                administration.
              </li>
              <li>
                <strong>Consistency Impact:</strong> Days with consistent timing show 17% higher
                performance metrics than days with variable timing.
              </li>
              <li>
                <strong>Subject-Specific Patterns:</strong> Focus enhancement is most notable during
                morning reading activities (8:30-10:30 AM) and afternoon mathematics (1:00-2:30 PM).
              </li>
              <li>
                <strong>Environmental Factors:</strong> Medication effectiveness appears enhanced on
                days with structured classroom activities and reduced on days with high
                environmental stimulation.
              </li>
            </ul>

            <h4 style="margin-top: 20px">Recommendations</h4>
            <p>
              Based on the observed patterns, consider maintaining medication administration at 7:30
              AM consistently. Schedule most challenging academic tasks between 9:00-11:30 AM when
              medication effectiveness appears optimal.
            </p>

            <div
              style="
                background-color: rgba(52, 152, 219, 0.1);
                padding: 15px;
                border-radius: var(--border-radius);
                margin-top: 15px;
              "
            >
              <p>
                <strong>Note:</strong> This analysis is for educational support purposes only.
                Always consult with healthcare providers before making any changes to medication
                schedules or dosages.
              </p>
            </div>
          </div>
        </div>
      </div>
    </main>

    <div id="help-bubble" class="help-character">üë©‚Äç‚öïÔ∏è</div>

    <div id="help-content" class="help-panel">
      <div class="help-panel-header">
        <span class="help-character-name">Dr. Emma - Timeline Guide</span>
        <button id="help-close">‚úï</button>
      </div>
      <div class="help-message dyslexia-friendly-text">
        <p>
          Hi there! I'm Dr. Emma, your medication timeline guide. I notice you're exploring our
          interactive medication timeline visualization. How can I help you today?
        </p>
      </div>
      <div class="help-options">
        <div class="help-option dyslexia-friendly-text">How do I use the timeline?</div>
        <div class="help-option dyslexia-friendly-text">What do the different colors mean?</div>
        <div class="help-option dyslexia-friendly-text">How is academic performance measured?</div>
        <div class="help-option dyslexia-friendly-text">Can I add events to the timeline?</div>
      </div>
    </div>

    <script>
      // Sample data for the timeline
      const timelineData = {
        events: [
          {
            id: 1,
            type: 'medication',
            title: 'Adderall XR 10mg',
            date: '2025-04-01',
            time: '07:30',
            description: 'Morning dose with breakfast',
            position: 100,
          },
          {
            id: 2,
            type: 'academic',
            title: 'Reading Comprehension Test',
            date: '2025-04-01',
            time: '10:30',
            description: 'Scored 85% (Above average)',
            position: 100,
          },
          {
            id: 3,
            type: 'medication',
            title: 'Adderall XR 10mg',
            date: '2025-04-02',
            time: '07:30',
            description: 'Morning dose with breakfast',
            position: 200,
          },
          {
            id: 4,
            type: 'behavioral',
            title: 'Classroom Observation',
            date: '2025-04-02',
            time: '13:15',
            description: 'Sustained attention during group work',
            position: 200,
          },
          {
            id: 5,
            type: 'medication',
            title: 'Adderall XR 10mg',
            date: '2025-04-03',
            time: '07:30',
            description: 'Morning dose with breakfast',
            position: 300,
          },
          {
            id: 6,
            type: 'medication',
            title: 'Adderall XR 10mg',
            date: '2025-04-04',
            time: '07:30',
            description: 'Morning dose with breakfast',
            position: 400,
          },
          {
            id: 7,
            type: 'medication',
            title: 'Adderall XR 10mg',
            date: '2025-04-07',
            time: '07:30',
            description: 'Morning dose with breakfast',
            position: 700,
          },
          {
            id: 8,
            type: 'academic',
            title: 'Math Quiz',
            date: '2025-04-08',
            time: '09:15',
            description: 'Scored 90% (Well above average)',
            position: 800,
          },
          {
            id: 9,
            type: 'medication',
            title: 'Adderall XR 10mg',
            date: '2025-04-08',
            time: '07:30',
            description: 'Morning dose with breakfast',
            position: 800,
          },
          {
            id: 10,
            type: 'medication',
            title: 'Adderall XR 10mg',
            date: '2025-04-09',
            time: '07:30',
            description: 'Morning dose with breakfast',
            position: 900,
          },
          {
            id: 11,
            type: 'observation',
            title: 'Teacher Note',
            date: '2025-04-09',
            time: '14:00',
            description: 'Reported headache in afternoon',
            position: 900,
          },
          {
            id: 12,
            type: 'medication',
            title: 'Adderall XR 10mg',
            date: '2025-04-10',
            time: '07:30',
            description: 'Morning dose with breakfast',
            position: 1000,
          },
          {
            id: 13,
            type: 'academic',
            title: 'Reading Group',
            date: '2025-04-10',
            time: '10:30',
            description: 'High engagement and participation',
            position: 1000,
          },
          {
            id: 14,
            type: 'missed',
            title: 'Missed Dose',
            date: '2025-04-11',
            time: '07:30',
            description: 'Dose missed due to doctor appointment',
            position: 1100,
          },
          {
            id: 15,
            type: 'observation',
            title: 'Teacher Note',
            date: '2025-04-11',
            time: '11:00',
            description: 'Difficulty focusing during morning lessons',
            position: 1100,
          },
          {
            id: 16,
            type: 'medication',
            title: 'Adderall XR 10mg',
            date: '2025-04-14',
            time: '07:30',
            description: 'Morning dose with breakfast',
            position: 1400,
          },
          {
            id: 17,
            type: 'academic',
            title: 'Science Project',
            date: '2025-04-14',
            time: '13:30',
            description: 'Completed project with minimal assistance',
            position: 1400,
          },
          {
            id: 18,
            type: 'medication',
            title: 'Adderall XR 10mg',
            date: '2025-04-15',
            time: '08:15',
            description: 'Delayed dose due to late start',
            position: 1500,
          },
          {
            id: 19,
            type: 'behavioral',
            title: 'Afternoon Check-in',
            date: '2025-04-15',
            time: '14:30',
            description: 'Reported feeling tired earlier than usual',
            position: 1500,
          },
        ],
      };

      // Sample data for correlation chart
      const correlationData = [
        {
          time: '07:30',
          performance: 85,
          day: 'April 1',
          notes: 'Regular dose time, high focus during morning activities',
        },
        {
          time: '07:30',
          performance: 82,
          day: 'April 2',
          notes: 'Regular dose time, sustained attention throughout day',
        },
        {
          time: '07:30',
          performance: 88,
          day: 'April 3',
          notes: 'Regular dose time, excellent focus during reading activities',
        },
        {
          time: '07:30',
          performance: 84,
          day: 'April 4',
          notes: 'Regular dose time, good focus but slightly distracted in afternoon',
        },
        {
          time: '07:30',
          performance: 86,
          day: 'April 7',
          notes: 'Regular dose time, high engagement in group activities',
        },
        {
          time: '07:30',
          performance: 90,
          day: 'April 8',
          notes: 'Regular dose time, excellent test performance in morning',
        },
        {
          time: '07:30',
          performance: 75,
          day: 'April 9',
          notes: 'Regular dose time, headache reported in afternoon',
        },
        {
          time: '07:30',
          performance: 88,
          day: 'April 10',
          notes: 'Regular dose time, high participation in reading group',
        },
        {
          time: '00:00',
          performance: 45,
          day: 'April 11',
          notes: 'Missed dose, significantly lower focus throughout day',
        },
        {
          time: '07:30',
          performance: 85,
          day: 'April 14',
          notes: 'Regular dose time, strong project work completion',
        },
        {
          time: '08:15',
          performance: 70,
          day: 'April 15',
          notes: 'Delayed dose, reported feeling tired earlier than usual',
        },
      ];

      // Initialize the timeline
      function initializeMedicationTimeline() {
        const timelineEvents = document.getElementById('timeline-events');
        timelineEvents.innerHTML = '';

        // Create timeline ruler tick marks
        for (let i = 0; i <= 14; i++) {
          const tick = document.createElement('div');
          tick.className = 'timeline-tick';
          tick.style.left = `${i * 100}px`;
          timelineEvents.appendChild(tick);

          const tickLabel = document.createElement('div');
          tickLabel.className = 'timeline-tick-label';
          tickLabel.textContent = `Apr ${i + 1}`;
          tickLabel.style.left = `${i * 100}px`;
          timelineEvents.appendChild(tickLabel);

          // Add week labels
          if (i % 7 === 0) {
            const weekLabel = document.createElement('div');
            weekLabel.className = 'timeline-week-label';
            weekLabel.textContent = `Week ${Math.floor(i / 7) + 1}`;
            weekLabel.style.left = `${i * 100 + 350}px`;
            timelineEvents.appendChild(weekLabel);
          }
        }

        // Create timeline events
        timelineData.events.forEach((event) => {
          const eventElement = document.createElement('div');
          eventElement.className = `timeline-event event-${event.type}`;
          eventElement.textContent = event.title;
          eventElement.style.left = `${event.position}px`;
          eventElement.setAttribute('data-event-id', event.id);

          eventElement.addEventListener('click', () => showEventDetails(event));

          timelineEvents.appendChild(eventElement);

          // Add connections between related events
          const relatedEvents = timelineData.events.filter(
            (e) => e.date === event.date && e.id !== event.id,
          );

          relatedEvents.forEach((relatedEvent) => {
            if (relatedEvent.id > event.id) {
              // Avoid duplicate connections
              const connection = document.createElement('div');
              connection.className = 'timeline-connection';
              connection.style.left = `${Math.min(event.position, relatedEvent.position)}px`;
              connection.style.width = `${Math.abs(event.position - relatedEvent.position)}px`;
              timelineEvents.appendChild(connection);
            }
          });
        });

        // Initialize the correlation chart
        initializeCorrelationChart();
      }

      // Initialize the correlation chart
      function initializeCorrelationChart() {
        const chart = document.getElementById('correlation-chart');

        // Clear existing points
        const existingPoints = chart.querySelectorAll('.correlation-point');
        existingPoints.forEach((point) => point.remove());

        // Calculate positions for the points
        correlationData.forEach((data) => {
          if (data.time === '00:00') return; // Skip missed doses

          // Convert time to position (6:30 AM to 8:30 AM range mapped to 50px to 550px)
          const [hours, minutes] = data.time.split(':').map(Number);
          const totalMinutes = hours * 60 + minutes;
          const startMinutes = 6 * 60 + 30; // 6:30 AM
          const minuteRange = 2 * 60; // 2 hours

          const xPos = 50 + ((totalMinutes - startMinutes) / minuteRange) * 500;

          // Map performance (0-100) to y position (250px to 50px, inverted)
          const yPos = 250 - (data.performance / 100) * 200;

          const point = document.createElement('div');
          point.className = 'correlation-point';
          point.style.left = `${xPos}px`;
          point.style.top = `${yPos}px`;
          point.style.backgroundColor = getPerformanceColor(data.performance);
          point.setAttribute('data-day', data.day);
          point.setAttribute('data-time', data.time);
          point.setAttribute('data-performance', data.performance);
          point.setAttribute('data-notes', data.notes);

          // Add hover event for tooltip
          point.addEventListener('mouseover', showCorrelationTooltip);
          point.addEventListener('mouseout', hideCorrelationTooltip);

          chart.appendChild(point);
        });

        // Add optimal time indicator (based on data analysis)
        const optimalTimeIndicator = document.createElement('div');
        optimalTimeIndicator.style.position = 'absolute';
        optimalTimeIndicator.style.left = '300px'; // 7:30 AM
        optimalTimeIndicator.style.top = '20px';
        optimalTimeIndicator.style.height = '230px';
        optimalTimeIndicator.style.width = '50px';
        optimalTimeIndicator.style.backgroundColor = 'rgba(46, 204, 113, 0.1)';
        optimalTimeIndicator.style.border = '1px dashed rgba(46, 204, 113, 0.5)';
        optimalTimeIndicator.style.borderRadius = '4px';
        optimalTimeIndicator.style.zIndex = '1';

        const optimalLabel = document.createElement('div');
        optimalLabel.style.position = 'absolute';
        optimalLabel.style.top = '5px';
        optimalLabel.style.left = '50%';
        optimalLabel.style.transform = 'translateX(-50%)';
        optimalLabel.style.fontSize = '0.8rem';
        optimalLabel.style.color = 'rgba(46, 204, 113, 0.8)';
        optimalLabel.style.whiteSpace = 'nowrap';
        optimalLabel.textContent = 'Optimal Time Window';

        optimalTimeIndicator.appendChild(optimalLabel);
        chart.appendChild(optimalTimeIndicator);
      }

      // Show correlation tooltip
      function showCorrelationTooltip(event) {
        const point = event.target;
        const tooltip = document.getElementById('correlation-tooltip');

        const day = point.getAttribute('data-day');
        const time = point.getAttribute('data-time');
        const performance = point.getAttribute('data-performance');
        const notes = point.getAttribute('data-notes');

        tooltip.innerHTML = `
        <div><strong>${day} at ${time}</strong></div>
        <div>Performance: ${performance}%</div>
        <div>${notes}</div>
      `;

        // Position the tooltip
        const rect = point.getBoundingClientRect();
        const chartRect = document.getElementById('correlation-chart').getBoundingClientRect();

        tooltip.style.left = `${rect.left - chartRect.left + 15}px`;
        tooltip.style.top = `${rect.top - chartRect.top - 10}px`;
        tooltip.style.opacity = '1';
      }

      // Hide correlation tooltip
      function hideCorrelationTooltip() {
        const tooltip = document.getElementById('correlation-tooltip');
        tooltip.style.opacity = '0';
      }

      // Get color based on performance score
      function getPerformanceColor(performance) {
        if (performance >= 85) return '#27ae60'; // High (success color)
        if (performance >= 70) return '#f1c40f'; // Medium (warning but lighter)
        return '#e74c3c'; // Low (danger color)
      }

      // Show event details
      function showEventDetails(event) {
        const detailPanel = document.getElementById('event-detail-panel');
        const detailTitle = detailPanel.querySelector('.event-detail-title');
        const detailContent = detailPanel.querySelector('.event-detail-content');

        detailTitle.textContent = event.title;

        let content = `
        <div class="dyslexia-friendly-text">
          <p><strong>Date & Time:</strong> April ${event.position / 100}, 2025, ${event.time}</p>
          <p><strong>Type:</strong> ${event.type.charAt(0).toUpperCase() + event.type.slice(1)}</p>
          <p><strong>Description:</strong> ${event.description}</p>
      `;

        // Add related events if any
        const relatedEvents = timelineData.events.filter(
          (e) => e.date === event.date && e.id !== event.id,
        );

        if (relatedEvents.length > 0) {
          content += `<h4 style="margin-top: 20px;">Related Events on Same Day</h4><ul>`;
          relatedEvents.forEach((related) => {
            content += `<li>${related.time} - ${related.title}: ${related.description}</li>`;
          });
          content += `</ul>`;
        }

        // Add next day events if available
        const nextDayEvents = timelineData.events.filter(
          (e) => parseInt(e.date.split('-')[2]) === event.position / 100 + 1,
        );

        if (nextDayEvents.length > 0) {
          content += `<h4 style="margin-top: 20px;">Next Day Events</h4><ul>`;
          nextDayEvents.forEach((nextDay) => {
            content += `<li>${nextDay.time} - ${nextDay.title}: ${nextDay.description}</li>`;
          });
          content += `</ul>`;
        }

        content += `
        </div>
        
        <div style="display: flex; gap: 10px; margin-top: 20px;">
          <button class="btn btn-outlined">Edit Details</button>
          <button class="btn btn-outlined">Add Observation</button>
        </div>
      `;

        detailContent.innerHTML = content;
        detailPanel.style.display = 'block';
      }

      // Close event detail panel
      document.getElementById('close-detail-panel').addEventListener('click', () => {
        document.getElementById('event-detail-panel').style.display = 'none';
      });

      // Timeline controls
      document.getElementById('move-left').addEventListener('click', () => {
        const timeline = document.querySelector('.timeline');
        timeline.scrollBy({ left: -300, behavior: 'smooth' });
      });

      document.getElementById('move-right').addEventListener('click', () => {
        const timeline = document.querySelector('.timeline');
        timeline.scrollBy({ left: 300, behavior: 'smooth' });
      });

      document.getElementById('go-to-today').addEventListener('click', () => {
        const timeline = document.querySelector('.timeline');
        const todayMarker = document.querySelector('.timeline-today-marker');
        const markerPosition = parseInt(todayMarker.style.left) - timeline.clientWidth / 2;
        timeline.scrollTo({ left: markerPosition, behavior: 'smooth' });
      });

      // Zoom controls
      document.getElementById('zoom-in').addEventListener('click', () => {
        const zoomSlider = document.getElementById('zoom-level');
        if (parseInt(zoomSlider.value) < parseInt(zoomSlider.max)) {
          zoomSlider.value = parseInt(zoomSlider.value) + 1;
          updateZoom();
        }
      });

      document.getElementById('zoom-out').addEventListener('click', () => {
        const zoomSlider = document.getElementById('zoom-level');
        if (parseInt(zoomSlider.value) > parseInt(zoomSlider.min)) {
          zoomSlider.value = parseInt(zoomSlider.value) - 1;
          updateZoom();
        }
      });

      document.getElementById('zoom-level').addEventListener('input', updateZoom);

      function updateZoom() {
        const zoomLevel = parseInt(document.getElementById('zoom-level').value);
        const zoomLabel = document.getElementById('zoom-label');
        const timelineEvents = document.getElementById('timeline-events');

        // Calculate scale based on zoom level (1-5)
        const zoomLabels = ['1 week', '10 days', '2 weeks', '3 weeks', 'Full month'];
        zoomLabel.textContent = `View: ${zoomLabels[zoomLevel - 1]}`;

        // Update scale of timeline events
        const scale = 1 + (zoomLevel - 3) * 0.25; // Scale factor based on zoom level
        timelineEvents.style.transform = `scaleX(${1 / scale})`;

        // Update positions of tick marks and events
        const tickWidth = 100 / scale;
        document.querySelectorAll('.timeline-tick').forEach((tick, index) => {
          tick.style.left = `${index * tickWidth}px`;
        });

        document.querySelectorAll('.timeline-tick-label').forEach((label, index) => {
          label.style.left = `${index * tickWidth}px`;
        });

        document.querySelectorAll('.timeline-week-label').forEach((label, index) => {
          label.style.left = `${index * 7 * tickWidth + 350 / scale}px`;
        });

        timelineData.events.forEach((event) => {
          const eventElement = document.querySelector(
            `.timeline-event[data-event-id="${event.id}"]`,
          );
          if (eventElement) {
            eventElement.style.left = `${event.position / scale}px`;
          }
        });

        // Update connections
        document.querySelectorAll('.timeline-connection').forEach((connection) => {
          connection.remove();
        });

        // Recreate connections with new positions
        timelineData.events.forEach((event) => {
          const relatedEvents = timelineData.events.filter(
            (e) => e.date === event.date && e.id !== event.id,
          );

          relatedEvents.forEach((relatedEvent) => {
            if (relatedEvent.id > event.id) {
              // Avoid duplicate connections
              const connection = document.createElement('div');
              connection.className = 'timeline-connection';
              connection.style.left = `${Math.min(event.position, relatedEvent.position) / scale}px`;
              connection.style.width = `${Math.abs(event.position - relatedEvent.position) / scale}px`;
              timelineEvents.appendChild(connection);
            }
          });
        });

        // Update today marker
        document.querySelector('.timeline-today-marker').style.left = `${1500 / scale}px`;
      }

      // Filter controls
      document.getElementById('show-medication').addEventListener('change', (event) => {
        const elements = document.querySelectorAll('.event-medication');
        elements.forEach((el) => {
          el.style.display = event.target.checked ? 'block' : 'none';
        });
      });

      document.getElementById('show-academic').addEventListener('change', (event) => {
        const elements = document.querySelectorAll('.event-academic');
        elements.forEach((el) => {
          el.style.display = event.target.checked ? 'block' : 'none';
        });
      });

      document.getElementById('show-behavioral').addEventListener('change', (event) => {
        const elements = document.querySelectorAll('.event-behavioral');
        elements.forEach((el) => {
          el.style.display = event.target.checked ? 'block' : 'none';
        });
      });

      document.getElementById('show-missed').addEventListener('change', (event) => {
        const elements = document.querySelectorAll('.event-missed');
        elements.forEach((el) => {
          el.style.display = event.target.checked ? 'block' : 'none';
        });
      });

      document.getElementById('show-observations').addEventListener('change', (event) => {
        const elements = document.querySelectorAll('.event-observation');
        elements.forEach((el) => {
          el.style.display = event.target.checked ? 'block' : 'none';
        });
      });

      // Analyze correlation button
      document.getElementById('analyze-correlation-btn').addEventListener('click', () => {
        const aiAnalysisPanel = document.getElementById('ai-analysis-panel');

        if (aiAnalysisPanel.style.display === 'none') {
          aiAnalysisPanel.style.display = 'block';
          document.getElementById('analyze-correlation-btn').textContent = 'Hide Analysis';

          // Scroll to analysis panel
          aiAnalysisPanel.scrollIntoView({ behavior: 'smooth', block: 'start' });
        } else {
          aiAnalysisPanel.style.display = 'none';
          document.getElementById('analyze-correlation-btn').textContent = 'Analyze Patterns';
        }
      });

      // Update performance metric selection
      document
        .getElementById('performance-metric')
        .addEventListener('change', initializeCorrelationChart);

      // Text-to-speech functionality
      document.querySelectorAll('.text-to-speech-btn').forEach((btn) => {
        btn.addEventListener('click', () => {
          // Get the parent card
          const card = btn.closest('.card');
          // Get the text content
          const textContent = card.querySelector('.card-content').textContent.trim();

          // Use the browser's speech synthesis API
          if ('speechSynthesis' in window) {
            const speech = new SpeechSynthesisUtterance();
            speech.text = textContent;
            speech.rate = 0.9; // Slightly slower rate for dyslexic readers
            speech.pitch = 1;
            window.speechSynthesis.speak(speech);
          } else {
            alert('Sorry, your browser does not support text-to-speech!');
          }
        });
      });

      // Reading guide functionality
      document.querySelectorAll('.reading-guide').forEach((guide) => {
        guide.addEventListener('click', () => {
          guide.style.backgroundColor = 'rgba(52, 152, 219, 0.4)';
          setTimeout(() => {
            guide.style.backgroundColor = 'rgba(52, 152, 219, 0.2)';
          }, 1000);
        });
      });

      // Help bubble functionality
      const helpBubble = document.getElementById('help-bubble');
      const helpContent = document.getElementById('help-content');
      const helpClose = document.getElementById('help-close');

      helpBubble.addEventListener('click', () => {
        helpContent.classList.toggle('active');
      });

      helpClose.addEventListener('click', () => {
        helpContent.classList.remove('active');
      });

      // Help options functionality
      document.querySelectorAll('.help-option').forEach((option) => {
        option.addEventListener('click', () => {
          const optionText = option.textContent.trim();

          // Simple response system
          let response = '';

          if (optionText.includes('How do I use the timeline')) {
            response =
              'The timeline shows medication events and academic activities chronologically. Use the zoom slider to adjust the view from a week to a full month. Navigate with the arrow buttons or drag the timeline horizontally. Click on any event for details. Toggle event types with the filters above the timeline. The correlation chart below shows relationships between medication timing and performance.';
          } else if (optionText.includes('different colors mean')) {
            response =
              'The timeline uses color-coding to distinguish different event types: Orange represents medication administration, Green shows academic assessments, Blue indicates behavioral observations, Red with dashed borders shows missed doses, and Gray represents general observations from parents or teachers. Each color helps you quickly identify patterns across different event types.';
          } else if (optionText.includes('academic performance measured')) {
            response =
              'Academic performance is measured through multiple metrics that you can select in the correlation chart: Focus Duration tracks time on task, Classroom Engagement measures participation levels, Task Completion Rate tracks assignment completion, Assessment Scores reflect test results, and the Combined Performance Index provides a weighted average of all metrics for a comprehensive view.';
          } else if (optionText.includes('Can I add events')) {
            response =
              "Yes! Click on any event to see details, then use the 'Add Observation' button to add related observations. To add a new medication event, return to the Medication Tracker page and use the 'Add Medication Entry' feature. All new entries are automatically synchronized with this timeline visualization for continuous tracking and analysis.";
          }

          // Update the help message
          document.querySelector('.help-message').innerHTML = `<p>${response}</p>`;

          // Update the help options
          const helpOptions = document.querySelector('.help-options');
          helpOptions.innerHTML = `
          <div class="help-option dyslexia-friendly-text">What does the correlation chart show?</div>
          <div class="help-option dyslexia-friendly-text">How can I export this data?</div>
          <div class="help-option dyslexia-friendly-text">Can I share this with my child's doctor?</div>
          <div class="help-option dyslexia-friendly-text">I have a different question</div>
        `;
        });
      });

      // Initialize the page when loaded
      window.addEventListener('DOMContentLoaded', () => {
        initializeMedicationTimeline();

        // Scroll to the current day position
        setTimeout(() => {
          const timeline = document.querySelector('.timeline');
          const todayMarker = document.querySelector('.timeline-today-marker');
          const markerPosition = parseInt(todayMarker.style.left) - timeline.clientWidth / 2;
          timeline.scrollLeft = markerPosition;
        }, 500);
      });
    </script>
  </body>
</html>
