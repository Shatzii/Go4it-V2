<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Curriculum Transformer - ShatziiOS</title>
    <link rel="stylesheet" href="/css/neurodivergent-support.css" />
    <style>
      :root {
        --primary: #4f46e5;
        --primary-hover: #4338ca;
        --background: #f5f7fa;
        --card-bg: #ffffff;
        --text: #333333;
        --border: #e5e7eb;
      }

      body {
        font-family:
          system-ui,
          -apple-system,
          BlinkMacSystemFont,
          'Segoe UI',
          Roboto,
          sans-serif;
        line-height: 1.6;
        margin: 0;
        padding: 0;
        background-color: var(--background);
        color: var(--text);
      }

      header {
        background-color: var(--primary);
        color: white;
        padding: 1rem;
        text-align: center;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem 1rem;
      }

      .card {
        background-color: var(--card-bg);
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        padding: 1.5rem;
        margin-bottom: 1.5rem;
      }

      .form-group {
        margin-bottom: 1.5rem;
      }

      label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 500;
      }

      select,
      input[type='text'],
      input[type='file'],
      textarea {
        width: 100%;
        padding: 0.75rem;
        border: 1px solid var(--border);
        border-radius: 4px;
        font-family: inherit;
        font-size: 1rem;
        background-color: white;
      }

      textarea {
        min-height: 150px;
        resize: vertical;
      }

      button {
        background-color: var(--primary);
        color: white;
        border: none;
        border-radius: 4px;
        padding: 0.75rem 1.5rem;
        font-size: 1rem;
        cursor: pointer;
        font-weight: 500;
        transition: background-color 0.2s;
      }

      button:hover {
        background-color: var(--primary-hover);
      }

      .tabs {
        display: flex;
        border-bottom: 1px solid var(--border);
        margin-bottom: 1.5rem;
      }

      .tab {
        padding: 0.75rem 1.5rem;
        cursor: pointer;
        border-bottom: 3px solid transparent;
        transition: all 0.2s;
      }

      .tab.active {
        border-bottom-color: var(--primary);
        color: var(--primary);
        font-weight: 500;
      }

      .tab-content {
        display: none;
      }

      .tab-content.active {
        display: block;
      }

      .settings-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 1rem;
        margin-bottom: 1.5rem;
      }

      .settings-card {
        border: 1px solid var(--border);
        border-radius: 8px;
        padding: 1rem;
      }

      .settings-card h3 {
        margin-top: 0;
        border-bottom: 1px solid var(--border);
        padding-bottom: 0.5rem;
        font-size: 1.1rem;
      }

      .radio-group {
        display: flex;
        gap: 1rem;
        flex-wrap: wrap;
      }

      .radio-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .preview {
        border: 1px solid var(--border);
        border-radius: 8px;
        padding: 1rem;
        margin-top: 1.5rem;
        background-color: white;
      }

      .preview h3 {
        margin-top: 0;
        border-bottom: 1px solid var(--border);
        padding-bottom: 0.5rem;
      }

      .result-container {
        border: 1px solid var(--border);
        border-radius: 8px;
        padding: 1rem;
        margin-top: 1.5rem;
        background-color: white;
        max-height: 500px;
        overflow-y: auto;
      }

      .toggle-group {
        display: flex;
        gap: 0.5rem;
        flex-wrap: wrap;
        margin-bottom: 1rem;
      }

      .toggle-button {
        background-color: #f3f4f6;
        border: 1px solid #e5e7eb;
        border-radius: 4px;
        padding: 0.5rem 1rem;
        cursor: pointer;
        transition: all 0.2s;
      }

      .toggle-button.active {
        background-color: var(--primary);
        color: white;
        border-color: var(--primary);
      }

      .loading {
        display: none;
        text-align: center;
        padding: 2rem;
      }

      .loading-spinner {
        border: 4px solid rgba(0, 0, 0, 0.1);
        border-left-color: var(--primary);
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
        margin: 0 auto 1rem;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .font-toggle {
        display: flex;
        align-items: center;
        margin-bottom: 1rem;
        gap: 0.5rem;
      }

      .font-toggle label {
        margin-bottom: 0;
        cursor: pointer;
      }

      @media (max-width: 768px) {
        .settings-grid {
          grid-template-columns: 1fr;
        }

        .tabs {
          flex-direction: column;
          border-bottom: none;
        }

        .tab {
          border-bottom: none;
          border-left: 3px solid transparent;
          margin-bottom: 0.5rem;
        }

        .tab.active {
          border-bottom: none;
          border-left-color: var(--primary);
          background-color: rgba(79, 70, 229, 0.1);
        }
      }
    </style>
  </head>
  <body>
    <header>
      <h1>Curriculum Transformer</h1>
      <p>Adapt educational content for neurodivergent learners</p>
    </header>

    <div class="container">
      <div class="card">
        <div class="tabs">
          <div class="tab active" data-tab="upload">Upload Content</div>
          <div class="tab" data-tab="paste">Paste Text</div>
          <div class="tab" data-tab="url">Import from URL</div>
          <div class="tab" data-tab="settings">Settings</div>
        </div>

        <div class="tab-content active" id="upload-content">
          <form id="upload-form">
            <div class="form-group">
              <label for="file-upload">Upload Document</label>
              <input type="file" id="file-upload" accept=".pdf,.doc,.docx,.txt,.html" />
              <small>Supported formats: PDF, Word, TXT, HTML</small>
            </div>
            <button type="submit">Upload & Transform</button>
          </form>
        </div>

        <div class="tab-content" id="paste-content">
          <form id="paste-form">
            <div class="form-group">
              <label for="paste-text">Paste Educational Content</label>
              <textarea
                id="paste-text"
                placeholder="Paste your educational content here..."
              ></textarea>
            </div>
            <button type="submit">Transform Content</button>
          </form>
        </div>

        <div class="tab-content" id="url-content">
          <form id="url-form">
            <div class="form-group">
              <label for="content-url">URL to Educational Content</label>
              <input
                type="text"
                id="content-url"
                placeholder="https://example.com/educational-content"
              />
            </div>
            <button type="submit">Import & Transform</button>
          </form>
        </div>

        <div class="tab-content" id="settings-content">
          <div class="settings-grid">
            <div class="settings-card">
              <h3>Learning Difference</h3>
              <div class="radio-group">
                <div class="radio-item">
                  <input
                    type="radio"
                    name="learning-difference"
                    id="dyslexia"
                    value="dyslexia"
                    checked
                  />
                  <label for="dyslexia">Dyslexia</label>
                </div>
                <div class="radio-item">
                  <input type="radio" name="learning-difference" id="adhd" value="adhd" />
                  <label for="adhd">ADHD</label>
                </div>
                <div class="radio-item">
                  <input type="radio" name="learning-difference" id="autism" value="autism" />
                  <label for="autism">Autism Spectrum</label>
                </div>
                <div class="radio-item">
                  <input type="radio" name="learning-difference" id="multiple" value="multiple" />
                  <label for="multiple">Multiple</label>
                </div>
              </div>
            </div>

            <div class="settings-card">
              <h3>Grade Level</h3>
              <div class="form-group">
                <select id="grade-level">
                  <option value="k-2">Kindergarten - 2nd Grade</option>
                  <option value="3-6">3rd - 6th Grade</option>
                  <option value="7-8">7th - 8th Grade</option>
                  <option value="9-12">9th - 12th Grade</option>
                  <option value="college">College/University</option>
                  <option value="adult">Adult Education</option>
                </select>
              </div>
            </div>

            <div class="settings-card">
              <h3>Language</h3>
              <div class="form-group">
                <select id="language">
                  <option value="english">English</option>
                  <option value="spanish">Spanish</option>
                  <option value="german">German</option>
                </select>
              </div>
            </div>

            <div class="settings-card">
              <h3>School Program</h3>
              <div class="form-group">
                <select id="school-program">
                  <option value="primary">K-6 Primary School</option>
                  <option value="secondary">7-12 Secondary School</option>
                  <option value="law">The Lawyer Makers</option>
                  <option value="language">Language Learning School</option>
                </select>
              </div>
            </div>
          </div>

          <div class="settings-card">
            <h3>Transformation Options</h3>
            <div class="toggle-group">
              <button type="button" class="toggle-button active" data-feature="simplified-language">
                Simplified Language
              </button>
              <button type="button" class="toggle-button active" data-feature="visual-supports">
                Visual Supports
              </button>
              <button type="button" class="toggle-button active" data-feature="clear-structure">
                Clear Structure
              </button>
              <button type="button" class="toggle-button active" data-feature="focus-helpers">
                Focus Helpers
              </button>
              <button type="button" class="toggle-button" data-feature="audio-supports">
                Audio Supports
              </button>
              <button type="button" class="toggle-button" data-feature="parent-notes">
                Parent Notes
              </button>
            </div>
          </div>

          <div class="font-toggle">
            <input type="checkbox" id="dyslexic-font" checked />
            <label for="dyslexic-font">Use OpenDyslexic Font</label>
          </div>

          <button id="apply-settings">Apply Settings</button>
        </div>
      </div>

      <div class="loading">
        <div class="loading-spinner"></div>
        <p>Transforming content for neurodivergent learners...</p>
        <p><small>This may take a few moments depending on content length</small></p>
      </div>

      <div class="preview" style="display: none">
        <h3>Preview</h3>
        <div id="preview-content">
          <p>Your transformed content will appear here.</p>
        </div>
      </div>

      <div class="result-container" style="display: none">
        <div id="result-content"></div>
        <div class="form-group" style="margin-top: 1rem">
          <button id="download-result">Download Transformed Content</button>
          <button id="copy-result">Copy to Clipboard</button>
        </div>
      </div>
    </div>

    <script>
      document.addEventListener('DOMContentLoaded', function () {
        // Tab switching
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');

        tabs.forEach((tab) => {
          tab.addEventListener('click', () => {
            const tabId = tab.getAttribute('data-tab');

            // Remove active class from all tabs and contents
            tabs.forEach((t) => t.classList.remove('active'));
            tabContents.forEach((content) => content.classList.remove('active'));

            // Add active class to clicked tab and corresponding content
            tab.classList.add('active');
            document.getElementById(`${tabId}-content`).classList.add('active');
          });
        });

        // Toggle buttons in settings
        const toggleButtons = document.querySelectorAll('.toggle-button');
        toggleButtons.forEach((button) => {
          button.addEventListener('click', () => {
            button.classList.toggle('active');
          });
        });

        // Handle form submissions
        const uploadForm = document.getElementById('upload-form');
        const pasteForm = document.getElementById('paste-form');
        const urlForm = document.getElementById('url-form');
        const applySettings = document.getElementById('apply-settings');

        uploadForm.addEventListener('submit', handleSubmit);
        pasteForm.addEventListener('submit', handleSubmit);
        urlForm.addEventListener('submit', handleSubmit);
        applySettings.addEventListener('click', applySettingsHandler);

        // Dyslexic font toggle
        const dyslexicFont = document.getElementById('dyslexic-font');
        dyslexicFont.addEventListener('change', () => {
          const resultContent = document.getElementById('result-content');
          if (dyslexicFont.checked) {
            resultContent.classList.add('dyslexia-friendly');
          } else {
            resultContent.classList.remove('dyslexia-friendly');
          }
        });

        // Download and copy buttons
        const downloadBtn = document.getElementById('download-result');
        const copyBtn = document.getElementById('copy-result');

        downloadBtn.addEventListener('click', downloadResult);
        copyBtn.addEventListener('click', copyResult);

        // Form submission handler
        function handleSubmit(e) {
          e.preventDefault();

          // Show loading
          document.querySelector('.loading').style.display = 'block';
          document.querySelector('.preview').style.display = 'none';
          document.querySelector('.result-container').style.display = 'none';

          // In a real implementation, this would send an API request
          // For this demo, we'll simulate the transformation with a timeout
          setTimeout(() => {
            // Hide loading
            document.querySelector('.loading').style.display = 'none';

            // Show results
            document.querySelector('.preview').style.display = 'block';
            document.querySelector('.result-container').style.display = 'block';

            // Get settings
            const learningDifference = document.querySelector(
              'input[name="learning-difference"]:checked',
            ).value;
            const gradeLevel = document.getElementById('grade-level').value;
            const language = document.getElementById('language').value;
            const schoolProgram = document.getElementById('school-program').value;

            // Generate demo content based on settings
            const resultContent = generateDemoContent(
              learningDifference,
              gradeLevel,
              language,
              schoolProgram,
            );

            // Update result content
            const resultElement = document.getElementById('result-content');
            resultElement.innerHTML = resultContent;

            // Apply dyslexia font if checked
            if (document.getElementById('dyslexic-font').checked) {
              resultElement.classList.add('dyslexia-friendly');
            } else {
              resultElement.classList.remove('dyslexia-friendly');
            }

            // Update preview
            document.getElementById('preview-content').innerHTML = `
                        <p>Content has been transformed for students with <strong>${learningDifference}</strong> 
                        at the <strong>${gradeLevel}</strong> level in <strong>${language}</strong> 
                        for the <strong>${schoolProgram}</strong> program.</p>
                    `;
          }, 2000);
        }

        function applySettingsHandler() {
          // Show a message that settings have been applied
          const settingsTab = document.querySelector('.tab[data-tab="settings"]');
          const uploadTab = document.querySelector('.tab[data-tab="upload"]');

          // Switch to upload tab
          uploadTab.click();

          // Show message
          alert('Settings applied! You can now upload or paste content to transform.');
        }

        function downloadResult() {
          const content = document.getElementById('result-content').innerHTML;
          const blob = new Blob([content], { type: 'text/html' });
          const url = URL.createObjectURL(blob);

          const a = document.createElement('a');
          a.href = url;
          a.download = 'transformed-content.html';
          a.click();

          URL.revokeObjectURL(url);
        }

        function copyResult() {
          const content = document.getElementById('result-content').innerText;
          navigator.clipboard
            .writeText(content)
            .then(() => {
              alert('Content copied to clipboard!');
            })
            .catch((err) => {
              console.error('Failed to copy: ', err);
            });
        }

        function generateDemoContent(learningDifference, gradeLevel, language, schoolProgram) {
          // Generate demo content based on the settings
          let content = '';

          // Default demo content
          const demoTitle = 'The Water Cycle';
          const demoText =
            'The water cycle describes how water evaporates from the surface of the earth, rises into the atmosphere, cools and condenses into rain or snow in clouds, and falls again to the surface as precipitation. The water that falls as rain and snow eventually reaches rivers, lakes, and oceans, and the cycle continues.';

          if (schoolProgram === 'primary') {
            // K-6 Primary School - Superhero theme
            content = `
                        <div class="superhero-element">
                            <h2>Super Science: ${demoTitle}</h2>
                            <p>Time to use your <strong>Super Vision</strong> to watch how water moves around our planet!</p>
                            
                            <div class="structured-content">
                                <div class="label">What is it?</div>
                                <div>The water cycle is like a never-ending race that water runs around the Earth!</div>
                                
                                <div class="label">Step 1:</div>
                                <div>Water <strong>evaporates</strong> (turns into vapor) from oceans, lakes, and rivers when the sun heats it up.</div>
                                
                                <div class="label">Step 2:</div>
                                <div>The water vapor <strong>rises</strong> high into the sky where it's cooler.</div>
                                
                                <div class="label">Step 3:</div>
                                <div>It <strong>condenses</strong> (turns into tiny droplets) to form clouds.</div>
                                
                                <div class="label">Step 4:</div>
                                <div>When the droplets get heavy enough, they fall as <strong>rain or snow</strong>.</div>
                                
                                <div class="label">Step 5:</div>
                                <div>The water <strong>collects</strong> in oceans, lakes, and rivers again, and the cycle continues!</div>
                            </div>
                            
                            <p>Use your <strong>Super Memory</strong> to remember these key words:</p>
                            <ul>
                                <li>Evaporation - Water turning into vapor</li>
                                <li>Condensation - Vapor turning into water droplets</li>
                                <li>Precipitation - Rain, snow, sleet, or hail falling from clouds</li>
                                <li>Collection - Water gathering in oceans, lakes, and rivers</li>
                            </ul>
                            
                            <p>Your <strong>Super Mission</strong>: Draw the water cycle and label each step!</p>
                        </div>
                    `;
          } else if (schoolProgram === 'secondary') {
            // 7-12 Secondary School - More mature theme
            content = `
                        <div class="focus-mode adhd-friendly">
                            <h2>${demoTitle}: Earth's Hydrological System</h2>
                            
                            <div class="structured-content">
                                <div class="label">Definition:</div>
                                <div>The water cycle (hydrologic cycle) is the continuous movement of water within Earth's hydrosphere, involving changes in its physical state between liquid, solid, and gas phases.</div>
                            </div>
                            
                            <h3>Key Processes</h3>
                            <ol>
                                <li><strong>Evaporation:</strong> The transformation of liquid water into water vapor due to solar radiation. Approximately 90% of atmospheric moisture comes from evaporation from bodies of water, while the remaining 10% comes from plant transpiration.</li>
                                <li><strong>Condensation:</strong> The conversion of water vapor to liquid water when the air becomes saturated. This occurs when the air cools to its dew point through contact with a cold surface or by rising in the atmosphere where the pressure and temperature decrease.</li>
                                <li><strong>Precipitation:</strong> The release of water from the atmosphere to Earth's surface in the form of rain, snow, sleet, or hail when tiny droplets of liquid water in clouds combine and become heavy enough to fall under gravity.</li>
                                <li><strong>Collection:</strong> The accumulation of water in various reservoirs such as oceans, rivers, lakes, groundwater, and glaciers. Approximately 97.5% of Earth's water is saline, with only 2.5% being freshwater.</li>
                            </ol>
                            
                            <h3>Environmental Importance</h3>
                            <p>The water cycle is crucial for:</p>
                            <ul>
                                <li>Regulating Earth's temperature</li>
                                <li>Replenishing freshwater sources</li>
                                <li>Supporting all living organisms</li>
                                <li>Weathering rocks and soil formation</li>
                                <li>Transporting minerals across the planet</li>
                            </ul>
                            
                            <div class="theme-blue">
                                <p><strong>Climate Impact:</strong> Climate change is altering precipitation patterns, increasing evaporation rates, and accelerating glacial melt, all of which disrupt the traditional water cycle and lead to more extreme weather events.</p>
                            </div>
                        </div>
                    `;
          } else if (schoolProgram === 'law') {
            // Law School - The Lawyer Makers
            content = `
                        <div class="focus-mode">
                            <h2>Environmental Law: Water Rights and Regulations</h2>
                            
                            <p>Understanding the water cycle is fundamental to comprehending the legal frameworks governing water resources. The physical processes of the water cycle intersect with legal doctrines in complex ways.</p>
                            
                            <h3>Key Legal Doctrines</h3>
                            <ul>
                                <li><span class="legal-term">Riparian Rights</span>: A system of allocating water among landowners whose properties adjoin a waterway. Based on the concept that water belongs to the land it touches.</li>
                                
                                <li><span class="legal-term">Prior Appropriation</span>: The "first in time, first in right" doctrine that governs water rights in many western states, where the first person to use the water has priority.</li>
                                
                                <li><span class="legal-term">Public Trust Doctrine</span>: The principle that certain natural resources, including water, are held in trust by the government for the benefit of the public.</li>
                            </ul>
                            
                            <div class="structured-content">
                                <div class="label">Case Study:</div>
                                <div><em>Colorado v. New Mexico</em> <span class="legal-citation">(459 U.S. 176, 1982)</span> - The Supreme Court established factors to consider in allocating water between states sharing an interstate river.</div>
                            </div>
                            
                            <h3>Federal Regulatory Framework</h3>
                            <ol>
                                <li><strong>Clean Water Act (CWA)</strong>: Establishes the basic structure for regulating discharges of pollutants into U.S. waters and setting quality standards for surface waters.</li>
                                
                                <li><strong>Safe Drinking Water Act (SDWA)</strong>: Ensures the quality of Americans' drinking water by setting standards to protect against both naturally-occurring and man-made contaminants.</li>
                                
                                <li><strong>Water Resources Development Act</strong>: Authorizes water resource projects carried out by the U.S. Army Corps of Engineers.</li>
                            </ol>
                            
                            <p>These legal frameworks must account for the natural constraints imposed by the water cycle, including precipitation patterns, groundwater recharge rates, and evaporation.</p>
                            
                            <div class="theme-cream">
                                <p><strong>Critical Legal Analysis:</strong> Consider how the physical properties of the water cycle challenge traditional legal concepts of "ownership" and "boundaries." How do stationary legal systems govern a resource that is constantly in motion?</p>
                            </div>
                        </div>
                    `;
          } else if (schoolProgram === 'language') {
            // Language Learning School
            const isGerman = language === 'german';
            const isSpanish = language === 'spanish';

            let originalTitle = 'The Water Cycle';
            let originalText =
              'The water cycle describes how water evaporates from the surface of the earth, rises into the atmosphere, cools and condenses into rain or snow in clouds, and falls again to the surface as precipitation.';

            let translatedTitle = isGerman
              ? 'Der Wasserkreislauf'
              : isSpanish
                ? 'El Ciclo del Agua'
                : 'The Water Cycle';
            let translatedText = isGerman
              ? 'Der Wasserkreislauf beschreibt, wie Wasser von der Erdoberfläche verdunstet, in die Atmosphäre aufsteigt, in Wolken abkühlt und zu Regen oder Schnee kondensiert und als Niederschlag wieder auf die Oberfläche fällt.'
              : isSpanish
                ? 'El ciclo del agua describe cómo el agua se evapora de la superficie de la tierra, sube a la atmósfera, se enfría y se condensa en lluvia o nieve en las nubes, y cae nuevamente a la superficie como precipitación.'
                : originalText;

            content = `
                        <div class="focus-mode">
                            <h2>${translatedTitle}</h2>
                            
                            <div class="multilingual-text">
                                <div class="original">
                                    <h3>English</h3>
                                    <p>${originalText}</p>
                                </div>
                                <div class="translation">
                                    <h3>${isGerman ? 'Deutsch' : isSpanish ? 'Español' : 'English'}</h3>
                                    <p>${translatedText}</p>
                                </div>
                            </div>
                            
                            <h3>Key Vocabulary</h3>
                            <div class="structured-content">
                                <div class="label">Water</div>
                                <div>${isGerman ? 'Wasser' : isSpanish ? 'Agua' : 'Water'}</div>
                                
                                <div class="label">Evaporation</div>
                                <div>${isGerman ? 'Verdunstung' : isSpanish ? 'Evaporación' : 'Evaporation'}</div>
                                
                                <div class="label">Atmosphere</div>
                                <div>${isGerman ? 'Atmosphäre' : isSpanish ? 'Atmósfera' : 'Atmosphere'}</div>
                                
                                <div class="label">Clouds</div>
                                <div>${isGerman ? 'Wolken' : isSpanish ? 'Nubes' : 'Clouds'}</div>
                                
                                <div class="label">Rain</div>
                                <div>${isGerman ? 'Regen' : isSpanish ? 'Lluvia' : 'Rain'}</div>
                                
                                <div class="label">Snow</div>
                                <div>${isGerman ? 'Schnee' : isSpanish ? 'Nieve' : 'Snow'}</div>
                                
                                <div class="label">Precipitation</div>
                                <div>${isGerman ? 'Niederschlag' : isSpanish ? 'Precipitación' : 'Precipitation'}</div>
                            </div>
                            
                            <div class="parent-mode">
                                <h3>Understanding Context (For Parents)</h3>
                                <p>This lesson introduces basic <span class="technical-term">scientific vocabulary</span> related to the water cycle.</p>
                                <p class="explanation">The scientific terms (evaporation, precipitation, etc.) may be challenging for language learners. Practice using these words in simple sentences about everyday weather observations.</p>
                                
                                <p>The lesson uses a <span class="technical-term">compare and contrast</span> approach with dual-language presentation.</p>
                                <p class="explanation">Seeing the content in both languages helps students make connections between their native language and the target language. Ask questions in one language and have your child respond in the other language.</p>
                            </div>
                        </div>
                    `;
          }

          // Apply specific neurodivergent adaptations
          if (learningDifference === 'dyslexia') {
            // Already using OpenDyslexic font via CSS class
            // Add additional accommodations for dyslexia
            content = `
                        <div class="dyslexia-friendly">
                            ${content}
                            <div class="card" style="margin-top: 1.5rem;">
                                <h3>Reading Aid Tools</h3>
                                <button class="tts-control" onclick="alert('Text-to-speech would start reading here')">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path><path d="M19.07 4.93a10 10 0 0 1 0 14.14"></path></svg>
                                    Read Aloud
                                </button>
                                <p>
                                    <label for="reading-speed">Reading Speed:</label>
                                    <input type="range" id="reading-speed" min="0.5" max="2" step="0.1" value="1">
                                </p>
                                <p>
                                    <button class="tts-control" onclick="alert('Reading ruler activated')">
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>
                                        Toggle Reading Ruler
                                    </button>
                                </p>
                            </div>
                        </div>
                    `;
          } else if (learningDifference === 'adhd') {
            // Add ADHD specific accommodations
            content = `
                        <div class="adhd-friendly">
                            ${content}
                            <div class="card" style="margin-top: 1.5rem;">
                                <h3>Focus Tools</h3>
                                <button class="tts-control" onclick="alert('Focus mode activated')">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="22" y1="12" x2="18" y2="12"></line><line x1="6" y1="12" x2="2" y2="12"></line><line x1="12" y1="6" x2="12" y2="2"></line><line x1="12" y1="22" x2="12" y2="18"></line></svg>
                                    Toggle Focus Mode
                                </button>
                                <p>
                                    <button class="tts-control" onclick="alert('Progress tracker activated')">
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="20" x2="18" y2="10"></line><line x1="12" y1="20" x2="12" y2="4"></line><line x1="6" y1="20" x2="6" y2="14"></line></svg>
                                        Track Progress
                                    </button>
                                </p>
                                <div style="margin-top: 1rem;">
                                    <p>Time remaining for this section: <strong>5:00</strong></p>
                                    <div style="height: 10px; background-color: #eee; border-radius: 5px;">
                                        <div style="width: 35%; height: 100%; background-color: #4f46e5; border-radius: 5px;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
          } else if (learningDifference === 'autism') {
            // Add autism specific accommodations
            content = `
                        <div class="autism-friendly">
                            ${content}
                            <div class="card" style="margin-top: 1.5rem;">
                                <h3>Sensory & Structure Tools</h3>
                                <div class="toggle-group">
                                    <button class="toggle-button" onclick="document.body.classList.toggle('theme-blue')">Blue Theme</button>
                                    <button class="toggle-button" onclick="document.body.classList.toggle('theme-cream')">Cream Theme</button>
                                    <button class="toggle-button" onclick="document.body.classList.toggle('theme-green')">Green Theme</button>
                                    <button class="toggle-button" onclick="document.body.classList.toggle('high-contrast')">High Contrast</button>
                                </div>
                                <div style="margin-top: 1rem;">
                                    <p>Next steps:</p>
                                    <ol>
                                        <li>Read through the content</li>
                                        <li>Complete the associated worksheet</li>
                                        <li>Participate in class discussion</li>
                                        <li>Take a 5-minute break</li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                    `;
          } else {
            // Multiple or combined accommodations
            content = `
                        <div class="dyslexia-friendly adhd-friendly autism-friendly">
                            ${content}
                            <div class="card" style="margin-top: 1.5rem;">
                                <h3>Accessibility Tools</h3>
                                <div class="toggle-group">
                                    <button class="toggle-button" onclick="alert('Text-to-speech would start reading here')">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path></svg>
                                        Read Aloud
                                    </button>
                                    <button class="toggle-button" onclick="document.body.classList.toggle('theme-blue')">Color Theme</button>
                                    <button class="toggle-button" onclick="alert('Focus mode activated')">Focus Mode</button>
                                    <button class="toggle-button" onclick="alert('Reading ruler activated')">Reading Ruler</button>
                                </div>
                                <div style="margin-top: 1rem;">
                                    <p>This content has been optimized with multiple accommodations including:</p>
                                    <ul>
                                        <li>OpenDyslexic font for improved readability</li>
                                        <li>Clear, consistent structure for predictability</li>
                                        <li>Focused layout to reduce distractions</li>
                                        <li>Color options for sensory preferences</li>
                                        <li>Reading tools for different learning needs</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    `;
          }

          return content;
        }
      });
    </script>
  </body>
</html>
