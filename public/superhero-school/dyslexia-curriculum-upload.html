<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Upload & Convert Curriculum | ShotziOS Educational Platform</title>
  <style>
    /* Base styles optimized for dyslexia */
    :root {
      --bg-color: #0f0f1a;
      --text-color: #e6e6ff;
      --accent-color: #3498db;
      --accent-dark: #2980b9;
      --accent-light: #5dade2;
      --card-bg: #1a1a2e;
      --nav-bg: #141428;
      --success-color: #27ae60;
      --warning-color: #e67e22;
      --danger-color: #e74c3c;
      --inactive-color: #7f8c8d;
      --header-height: 64px;
      --sidebar-width: 260px;
      --border-radius: 8px;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: "Open Dyslexic", "Comic Sans MS", Arial, sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      line-height: 1.6;
      letter-spacing: 0.025em;
      word-spacing: 0.1em;
      padding-bottom: 60px;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }
    
    /* Header styles */
    header {
      background-color: var(--nav-bg);
      height: var(--header-height);
      border-bottom: 2px solid var(--accent-color);
      position: sticky;
      top: 0;
      z-index: 100;
    }
    
    .header-content {
      display: flex;
      align-items: center;
      justify-content: space-between;
      height: 100%;
    }
    
    .logo {
      display: flex;
      align-items: center;
      font-size: 1.5rem;
      font-weight: bold;
      color: var(--accent-color);
    }
    
    .logo img {
      height: 40px;
      margin-right: 10px;
    }
    
    .avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background-color: var(--accent-color);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
    }
    
    /* Navigation */
    nav {
      background-color: var(--nav-bg);
      padding: 10px 0;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    
    .nav-links {
      display: flex;
      gap: 20px;
      list-style: none;
      overflow-x: auto;
      padding: 0 20px;
    }
    
    .nav-links li a {
      color: var(--text-color);
      text-decoration: none;
      padding: 5px 10px;
      border-radius: var(--border-radius);
      transition: all 0.3s ease;
      white-space: nowrap;
      font-weight: 500;
    }
    
    .nav-links li a:hover,
    .nav-links li a.active {
      background-color: var(--accent-color);
      color: white;
    }
    
    /* Main content area */
    main {
      padding: 20px 0;
    }
    
    h1, h2, h3, h4, h5, h6 {
      color: var(--accent-color);
      margin-bottom: 15px;
      margin-top: 30px;
      font-weight: 600;
    }
    
    h1 {
      font-size: 2rem;
      border-bottom: 2px solid var(--accent-color);
      padding-bottom: 10px;
      margin-bottom: 20px;
    }
    
    h2 {
      font-size: 1.5rem;
    }
    
    h3 {
      font-size: 1.25rem;
    }
    
    p {
      margin-bottom: 15px;
    }
    
    /* Card layouts */
    .card {
      background-color: var(--card-bg);
      border-radius: var(--border-radius);
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
      overflow: hidden;
      border-left: 4px solid var(--accent-color);
    }
    
    .card-header {
      padding: 15px 20px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
      font-weight: bold;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .card-content {
      padding: 20px;
    }
    
    /* Buttons */
    .btn {
      display: inline-block;
      background-color: var(--accent-color);
      color: white;
      padding: 10px 15px;
      border-radius: var(--border-radius);
      text-decoration: none;
      border: none;
      cursor: pointer;
      font-family: inherit;
      font-size: 1rem;
      transition: background-color 0.3s ease;
    }
    
    .btn:hover {
      background-color: var(--accent-dark);
    }
    
    .btn-success {
      background-color: var(--success-color);
    }
    
    .btn-success:hover {
      background-color: #219952;
    }
    
    .btn-warning {
      background-color: var(--warning-color);
    }
    
    .btn-warning:hover {
      background-color: #d35400;
    }
    
    .btn-danger {
      background-color: var(--danger-color);
    }
    
    .btn-danger:hover {
      background-color: #c0392b;
    }
    
    .btn-outlined {
      background-color: transparent;
      border: 2px solid var(--accent-color);
      color: var(--accent-color);
    }
    
    .btn-outlined:hover {
      background-color: var(--accent-color);
      color: white;
    }
    
    .btn:disabled, .btn.disabled {
      background-color: var(--inactive-color);
      cursor: not-allowed;
    }
    
    /* Form elements */
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
    }
    
    .form-control {
      width: 100%;
      padding: 10px 15px;
      background-color: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: var(--border-radius);
      color: var(--text-color);
      font-family: inherit;
      font-size: 1rem;
      transition: all 0.3s ease;
    }
    
    .form-control:focus {
      outline: none;
      border-color: var(--accent-color);
      box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.3);
    }
    
    select.form-control {
      appearance: none;
      background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23e6e6ff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 10px center;
      background-size: 16px;
      padding-right: 40px;
    }
    
    /* Loading spinner */
    .spinner {
      display: inline-block;
      width: 24px;
      height: 24px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: var(--accent-color);
      animation: spin 1s ease-in-out infinite;
      margin-right: 10px;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* Lesson content styles */
    .lesson-container {
      background-color: var(--card-bg);
      border-radius: var(--border-radius);
      padding: 20px;
      margin-top: 30px;
      display: none;
    }
    
    .lesson-title {
      color: var(--accent-color);
      font-size: 1.8rem;
      margin-bottom: 15px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      padding-bottom: 10px;
    }
    
    .lesson-metadata {
      margin-bottom: 20px;
      color: rgba(255, 255, 255, 0.7);
    }
    
    .lesson-objectives {
      margin-bottom: 20px;
    }
    
    .lesson-objectives h3 {
      color: var(--accent-color);
      margin-bottom: 10px;
    }
    
    .lesson-objectives ul {
      list-style-type: none;
      padding-left: 0;
    }
    
    .lesson-objectives li {
      margin-bottom: 8px;
      padding-left: 24px;
      position: relative;
    }
    
    .lesson-objectives li:before {
      content: "âœ“";
      position: absolute;
      left: 0;
      color: var(--accent-color);
    }
    
    .lesson-content {
      margin-bottom: 20px;
      line-height: 1.8;
    }
    
    .lesson-visuals {
      margin-bottom: 20px;
    }
    
    .lesson-visuals h3 {
      color: var(--accent-color);
      margin-bottom: 10px;
    }
    
    .visual-item {
      background-color: rgba(52, 152, 219, 0.1);
      border-radius: var(--border-radius);
      padding: 15px;
      margin-bottom: 15px;
      border-left: 3px solid var(--accent-color);
    }
    
    .lesson-activities {
      margin-bottom: 20px;
    }
    
    .lesson-activities h3 {
      color: var(--accent-color);
      margin-bottom: 10px;
    }
    
    .activity-item {
      background-color: rgba(39, 174, 96, 0.1);
      border-radius: var(--border-radius);
      padding: 15px;
      margin-bottom: 15px;
      border-left: 3px solid var(--success-color);
    }
    
    .lesson-assessment {
      margin-bottom: 20px;
    }
    
    .lesson-assessment h3 {
      color: var(--accent-color);
      margin-bottom: 10px;
    }
    
    .assessment-item {
      background-color: rgba(230, 126, 34, 0.1);
      border-radius: var(--border-radius);
      padding: 15px;
      margin-bottom: 15px;
      border-left: 3px solid var(--warning-color);
    }
    
    .lesson-resources {
      margin-bottom: 20px;
    }
    
    .lesson-resources h3 {
      color: var(--accent-color);
      margin-bottom: 10px;
    }
    
    .resource-item {
      display: inline-block;
      background-color: rgba(52, 152, 219, 0.1);
      border-radius: var(--border-radius);
      padding: 8px 12px;
      margin-right: 10px;
      margin-bottom: 10px;
      font-size: 0.9rem;
    }
    
    .lesson-actions {
      margin-top: 30px;
      display: flex;
      gap: 15px;
    }
    
    /* File upload styles */
    .file-upload {
      border: 2px dashed var(--accent-color);
      border-radius: var(--border-radius);
      padding: 20px;
      text-align: center;
      margin-bottom: 20px;
      background-color: rgba(52, 152, 219, 0.05);
      position: relative;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .file-upload:hover {
      background-color: rgba(52, 152, 219, 0.1);
    }
    
    .file-upload input[type="file"] {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      cursor: pointer;
    }
    
    .file-upload-icon {
      font-size: 2rem;
      color: var(--accent-color);
      margin-bottom: 10px;
    }
    
    .file-upload-text {
      color: var(--text-color);
      margin-bottom: 10px;
    }
    
    .file-upload-info {
      font-size: 0.9rem;
      color: rgba(255, 255, 255, 0.6);
    }
    
    .file-preview {
      display: none;
      background-color: rgba(52, 152, 219, 0.1);
      border-radius: var(--border-radius);
      padding: 15px;
      margin-top: 20px;
      margin-bottom: 20px;
    }
    
    .file-preview-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      padding-bottom: 10px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .file-preview-name {
      font-weight: bold;
      color: var(--accent-color);
    }
    
    .file-preview-remove {
      background: none;
      border: none;
      color: var(--text-color);
      cursor: pointer;
      font-size: 1.2rem;
    }
    
    .file-preview-content {
      max-height: 200px;
      overflow-y: auto;
      background-color: rgba(0, 0, 0, 0.2);
      padding: 10px;
      border-radius: var(--border-radius);
      font-family: monospace;
      white-space: pre-wrap;
      word-break: break-word;
    }
    
    /* API selection */
    .api-selection {
      margin-top: 20px;
      display: flex;
      align-items: center;
      gap: 15px;
    }
    
    .api-option {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
    }
    
    /* Help character bubble */
    .help-character {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: var(--accent-color);
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      cursor: pointer;
      z-index: 100;
      transition: all 0.3s ease;
    }
    
    .help-character:hover {
      transform: scale(1.1);
    }
    
    .help-panel {
      position: fixed;
      bottom: 90px;
      right: 20px;
      width: 300px;
      background-color: var(--card-bg);
      border-radius: var(--border-radius);
      padding: 15px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      z-index: 100;
      transition: all 0.3s ease;
      opacity: 0;
      visibility: hidden;
      transform: translateY(20px);
    }
    
    .help-panel.active {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }
    
    .help-panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      padding-bottom: 10px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    
    .help-character-name {
      font-weight: bold;
      color: var(--accent-color);
    }
    
    .help-close {
      background: none;
      border: none;
      color: var(--text-color);
      cursor: pointer;
      font-size: 1.2rem;
    }
    
    .help-message {
      margin-bottom: 15px;
    }
    
    .help-options {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .help-option {
      padding: 8px 12px;
      background-color: rgba(52, 152, 219, 0.1);
      border-radius: var(--border-radius);
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .help-option:hover {
      background-color: rgba(52, 152, 219, 0.3);
    }
    
    /* Responsive styles */
    @media (max-width: 768px) {
      .container {
        padding: 0 15px;
      }
      
      .nav-links {
        flex-wrap: wrap;
      }
      
      .lesson-actions {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <div class="header-content">
        <div class="logo">
          <img src="/logo.png" alt="ShotziOS Logo" />
          <span>ShotziOS Educational Platform</span>
        </div>
        <div class="avatar">S</div>
      </div>
    </div>
  </header>
  
  <nav>
    <div class="container">
      <ul class="nav-links">
        <li><a href="/dashboard">Dashboard</a></li>
        <li><a href="/superhero-school">Superhero School</a></li>
        <li><a href="/superhero-school/dyslexia-learning">Dyslexia Super-Learning</a></li>
        <li><a href="/superhero-school/adaptive-learning">AI Adaptive Learning</a></li>
        <li><a href="/superhero-school/dyslexia-curriculum-generator">Curriculum Generator</a></li>
        <li><a href="/superhero-school/dyslexia-curriculum-upload" class="active">Upload & Convert</a></li>
        <li><a href="/superhero-school/gpa-calculator">GPA Calculator</a></li>
        <li><a href="/superhero-school/medication-tracker">Medication Tracker</a></li>
      </ul>
    </div>
  </nav>
  
  <main class="container">
    <h1>Upload & Convert Regular Curriculum Materials</h1>
    
    <div class="card">
      <div class="card-header">
        <span>Convert Standard Curriculum to Dyslexia-Friendly Format</span>
      </div>
      <div class="card-content">
        <p>Upload your existing curriculum materials or assignments, and our AI will convert them into dyslexia-friendly formats that are easier for neurodivergent students to understand and learn from.</p>
        
        <p>Simply upload a text file (.txt), document (.doc, .docx), or PDF file containing your standard curriculum content, and specify the grade level and subject. Our AI will analyze the content and restructure it according to best practices for dyslexic learners.</p>
        
        <div class="info-box" style="background-color: rgba(52, 152, 219, 0.1); padding: 15px; border-radius: 8px; margin: 15px 0; border-left: 4px solid var(--accent-color);">
          <h3 style="margin-top: 0; color: var(--accent-color);">How We Convert Your Materials</h3>
          <p>Our AI adapts your standard curriculum materials by:</p>
          <ul style="list-style-type: none; padding-left: 0;">
            <li style="margin-bottom: 8px; padding-left: 24px; position: relative;">
              <span style="position: absolute; left: 0; color: var(--accent-color);">âœ“</span> 
              Breaking complex concepts into smaller, more digestible chunks
            </li>
            <li style="margin-bottom: 8px; padding-left: 24px; position: relative;">
              <span style="position: absolute; left: 0; color: var(--accent-color);">âœ“</span> 
              Converting dense text into bullet points and numbered lists
            </li>
            <li style="margin-bottom: 8px; padding-left: 24px; position: relative;">
              <span style="position: absolute; left: 0; color: var(--accent-color);">âœ“</span> 
              Adding visual descriptions and multisensory learning elements
            </li>
            <li style="margin-bottom: 8px; padding-left: 24px; position: relative;">
              <span style="position: absolute; left: 0; color: var(--accent-color);">âœ“</span> 
              Incorporating more frequent reviews and comprehension checks
            </li>
            <li style="margin-bottom: 8px; padding-left: 24px; position: relative;">
              <span style="position: absolute; left: 0; color: var(--accent-color);">âœ“</span> 
              Suggesting hands-on activities to reinforce concepts
            </li>
          </ul>
        </div>
        
        <form id="upload-form">
          <div class="form-group">
            <label class="form-label" for="grade">Grade Level:</label>
            <select class="form-control" id="grade" required>
              <option value="">Select grade level</option>
              <option value="K">Kindergarten</option>
              <option value="1">1st Grade</option>
              <option value="2">2nd Grade</option>
              <option value="3">3rd Grade</option>
              <option value="4">4th Grade</option>
              <option value="5">5th Grade</option>
              <option value="6">6th Grade</option>
              <option value="7">7th Grade</option>
              <option value="8">8th Grade</option>
              <option value="9">9th Grade</option>
              <option value="10">10th Grade</option>
              <option value="11">11th Grade</option>
              <option value="12">12th Grade</option>
              <option value="college-freshman">College Freshman</option>
              <option value="college-sophomore">College Sophomore</option>
              <option value="college-junior">College Junior</option>
              <option value="college-senior">College Senior</option>
              <option value="masters">Masters Level</option>
            </select>
          </div>
          
          <div class="form-group">
            <label class="form-label" for="subject">Subject:</label>
            <select class="form-control" id="subject" required>
              <option value="">Select a subject</option>
              <option value="reading">Reading</option>
              <option value="writing">Writing</option>
              <option value="mathematics">Mathematics</option>
              <option value="science">Science</option>
              <option value="social-studies">Social Studies</option>
              <option value="language-arts">Language Arts</option>
              <option value="history">History</option>
              <option value="art">Art</option>
              <option value="music">Music</option>
              <option value="physical-education">Physical Education</option>
              <option value="computer-science">Computer Science</option>
              <option value="foreign-language">Foreign Language</option>
              <option value="economics">Economics</option>
              <option value="psychology">Psychology</option>
              <option value="biology">Biology</option>
              <option value="chemistry">Chemistry</option>
              <option value="physics">Physics</option>
            </select>
          </div>
          
          <div class="form-group">
            <label class="form-label" for="format">Output Format:</label>
            <select class="form-control" id="format" required>
              <option value="">Select format</option>
              <option value="text">Text-based with dyslexia-friendly formatting</option>
              <option value="audio">Audio narration script</option>
              <option value="visual">Visual guide with descriptions for diagrams</option>
              <option value="game">Game-based interactive lesson</option>
              <option value="chat">Adaptive AI chat-based learning</option>
            </select>
            <div id="format-info" style="margin-top: 10px; font-size: 0.9rem; color: rgba(255,255,255,0.7);"></div>
          </div>
          
          <script>
            // Format examples
            document.getElementById('format').addEventListener('change', function() {
              const formatInfo = document.getElementById('format-info');
              const format = this.value;
              
              switch(format) {
                case 'text':
                  formatInfo.innerHTML = `
                    <strong>Example:</strong> Content broken into shorter paragraphs with increased line spacing, 
                    bold key terms, and bullet points for easier reading.
                  `;
                  break;
                case 'audio':
                  formatInfo.innerHTML = `
                    <strong>Example:</strong> "Now, let's focus on photosynthesis. [pause] 
                    First, plants absorb sunlight through their leaves. [pause] 
                    Next, they use this energy to convert water and carbon dioxide into food."
                  `;
                  break;
                case 'visual':
                  formatInfo.innerHTML = `
                    <strong>Example:</strong> "This diagram shows the water cycle: water evaporates from oceans (bottom), 
                    forms clouds (top), and falls as rain (right side). Each part is color-coded for easier tracking."
                  `;
                  break;
                case 'game':
                  formatInfo.innerHTML = `
                    <strong>Example:</strong> "Word Detective: Find and circle all the action verbs in the passage. 
                    Each correct verb earns you a point! Challenge: Can you act out 3 of these verbs?"
                  `;
                  break;
                case 'chat':
                  formatInfo.innerHTML = `
                    <strong>Example:</strong> Interactive Q&A format: "What happens when water boils? 
                    [student responds] That's right! Now let's think about why that happens..."
                  `;
                  break;
                default:
                  formatInfo.innerHTML = '';
              }
            });
          </script>
          
          <div class="form-group">
            <div class="file-upload">
              <div class="file-upload-icon">ðŸ“„</div>
              <div class="file-upload-text">Click to select or drag and drop your file here</div>
              <div class="file-upload-info">Supported formats: .txt, .docx, .pdf (max 10MB)</div>
              <input type="file" id="file-input" accept=".txt,.doc,.docx,.pdf" required />
            </div>
          </div>
          
          <div id="file-preview" class="file-preview">
            <div class="file-preview-header">
              <div class="file-preview-name" id="file-name"></div>
              <button type="button" class="file-preview-remove" id="remove-file">Ã—</button>
            </div>
            <div class="file-preview-content" id="file-content"></div>
          </div>
          
          <div class="api-selection">
            <span>AI Provider:</span>
            <label class="api-option">
              <input type="radio" name="api" value="anthropic" checked />
              <span>Claude (Anthropic)</span>
            </label>
            <label class="api-option">
              <input type="radio" name="api" value="perplexity" />
              <span>Perplexity</span>
            </label>
          </div>
          
          <div class="form-group" style="margin-top: 20px;">
            <button type="submit" id="convert-btn" class="btn btn-success">
              Convert to Dyslexia-Friendly Format
            </button>
          </div>
        </form>
      </div>
    </div>
    
    <div id="lesson-container" class="lesson-container">
      <h2 id="lesson-title" class="lesson-title">Lesson Title</h2>
      
      <div class="lesson-metadata">
        <strong>Grade Level:</strong> <span id="lesson-grade">5th Grade</span> | 
        <strong>Subject:</strong> <span id="lesson-subject">Mathematics</span>
      </div>
      
      <div class="lesson-objectives">
        <h3>Learning Objectives</h3>
        <ul id="lesson-objectives-list">
          <!-- Objectives will be populated here -->
        </ul>
      </div>
      
      <div class="lesson-content">
        <h3>Lesson Content</h3>
        <div id="lesson-content-text" class="dyslexia-friendly-text">
          <!-- Content will be populated here -->
        </div>
      </div>
      
      <div class="lesson-visuals">
        <h3>Visual Aids</h3>
        <div id="lesson-visuals-list">
          <!-- Visual descriptions will be populated here -->
        </div>
      </div>
      
      <div class="lesson-activities">
        <h3>Activities</h3>
        <div id="lesson-activities-list">
          <!-- Activities will be populated here -->
        </div>
      </div>
      
      <div class="lesson-assessment">
        <h3>Assessment</h3>
        <div id="lesson-assessment-list">
          <!-- Assessment items will be populated here -->
        </div>
      </div>
      
      <div class="lesson-resources">
        <h3>Additional Resources</h3>
        <div id="lesson-resources-list">
          <!-- Resources will be populated here -->
        </div>
      </div>
      
      <div class="lesson-actions">
        <button id="print-lesson-btn" class="btn">Print Lesson</button>
        <button id="save-lesson-btn" class="btn">Save as PDF</button>
        <button id="customize-lesson-btn" class="btn btn-outlined">Customize Lesson</button>
      </div>
    </div>
  </main>
  
  <!-- Help bubble -->
  <div class="help-character" id="help-bubble">
    ðŸ’¡
  </div>
  
  <div class="help-panel" id="help-panel">
    <div class="help-panel-header">
      <div class="help-character-name">Stella</div>
      <button class="help-close" id="help-close">Ã—</button>
    </div>
    <div class="help-message" id="help-message">
      Hi there! I'm Stella, your learning assistant. Need help converting your curriculum materials to be dyslexia-friendly?
    </div>
    <div class="help-options">
      <div class="help-option" data-option="what-is">What makes a curriculum dyslexia-friendly?</div>
      <div class="help-option" data-option="file-types">What file types can I upload?</div>
      <div class="help-option" data-option="formats">What are the different output formats?</div>
    </div>
  </div>
  
  <script>
    // DOM elements
    const fileInput = document.getElementById('file-input');
    const filePreview = document.getElementById('file-preview');
    const fileName = document.getElementById('file-name');
    const fileContent = document.getElementById('file-content');
    const removeFileBtn = document.getElementById('remove-file');
    const uploadForm = document.getElementById('upload-form');
    const convertBtn = document.getElementById('convert-btn');
    const lessonContainer = document.getElementById('lesson-container');
    
    // Lesson display elements
    const lessonTitle = document.getElementById('lesson-title');
    const lessonGrade = document.getElementById('lesson-grade');
    const lessonSubject = document.getElementById('lesson-subject');
    const lessonObjectivesList = document.getElementById('lesson-objectives-list');
    const lessonContentText = document.getElementById('lesson-content-text');
    const lessonVisualsList = document.getElementById('lesson-visuals-list');
    const lessonActivitiesList = document.getElementById('lesson-activities-list');
    const lessonAssessmentList = document.getElementById('lesson-assessment-list');
    const lessonResourcesList = document.getElementById('lesson-resources-list');
    
    // Action buttons
    const printLessonBtn = document.getElementById('print-lesson-btn');
    const saveLessonBtn = document.getElementById('save-lesson-btn');
    const customizeLessonBtn = document.getElementById('customize-lesson-btn');
    
    // Help panel elements
    const helpBubble = document.getElementById('help-bubble');
    const helpPanel = document.getElementById('help-panel');
    const helpClose = document.getElementById('help-close');
    const helpMessage = document.getElementById('help-message');
    const helpOptions = document.querySelectorAll('.help-option');
    
    // File upload handling
    fileInput.addEventListener('change', handleFileSelection);
    removeFileBtn.addEventListener('click', removeFile);
    
    // Form submission
    uploadForm.addEventListener('submit', handleFormSubmit);
    
    // Action buttons
    printLessonBtn.addEventListener('click', printLesson);
    saveLessonBtn.addEventListener('click', saveAsPDF);
    customizeLessonBtn.addEventListener('click', customizeLesson);
    
    // Help panel
    helpBubble.addEventListener('click', toggleHelpPanel);
    helpClose.addEventListener('click', closeHelpPanel);
    helpOptions.forEach(option => {
      option.addEventListener('click', handleHelpOptionClick);
    });
    
    /**
     * Handle file selection
     */
    function handleFileSelection(event) {
      const file = event.target.files[0];
      
      if (file) {
        fileName.textContent = file.name;
        
        // Only read and preview text files
        if (file.type === 'text/plain') {
          const reader = new FileReader();
          
          reader.onload = function(e) {
            const content = e.target.result;
            fileContent.textContent = content.substring(0, 1000) + (content.length > 1000 ? '...' : '');
          };
          
          reader.readAsText(file);
        } else {
          fileContent.textContent = `File preview not available for ${file.type} files.`;
        }
        
        filePreview.style.display = 'block';
      }
    }
    
    /**
     * Remove the selected file
     */
    function removeFile() {
      fileInput.value = '';
      filePreview.style.display = 'none';
      fileName.textContent = '';
      fileContent.textContent = '';
    }
    
    /**
     * Handle form submission
     */
    async function handleFormSubmit(event) {
      event.preventDefault();
      
      // Get form values
      const grade = document.getElementById('grade').value;
      const subject = document.getElementById('subject').value;
      const format = document.getElementById('format').value;
      const file = fileInput.files[0];
      const api = document.querySelector('input[name="api"]:checked').value;
      
      if (!grade || !subject || !format || !file) {
        alert('Please complete all fields and upload a file.');
        return;
      }
      
      // Show loading state
      convertBtn.disabled = true;
      convertBtn.innerHTML = '<span class="spinner"></span> Converting...';
      
      try {
        // Create form data for the file upload
        const formData = new FormData();
        formData.append('file', file);
        formData.append('grade', grade);
        formData.append('subject', subject);
        formData.append('format', format);
        formData.append('api', api);
        
        // Upload and convert the file
        const response = await fetch('/api/analyze-curriculum', {
          method: 'POST',
          body: formData
        });
        
        if (!response.ok) {
          const errorData = await response.json();
          throw new Error(errorData.error || 'An error occurred');
        }
        
        const data = await response.json();
        
        // Display the converted curriculum
        displayConvertedCurriculum(data.data);
        
        // Scroll to the lesson
        lessonContainer.scrollIntoView({ behavior: 'smooth' });
      } catch (error) {
        console.error('Error:', error);
        alert('Error: ' + (error.message || 'An error occurred while converting the curriculum.'));
      } finally {
        // Reset button state
        convertBtn.disabled = false;
        convertBtn.innerHTML = 'Convert to Dyslexia-Friendly Format';
      }
    }
    
    /**
     * Display the converted curriculum
     */
    function displayConvertedCurriculum(data) {
      // Set basic info
      lessonTitle.textContent = data.title || 'Converted Curriculum';
      lessonGrade.textContent = data.grade_level || '';
      lessonSubject.textContent = data.subject || '';
      
      // Set learning objectives
      lessonObjectivesList.innerHTML = '';
      if (Array.isArray(data.learning_objectives)) {
        data.learning_objectives.forEach(objective => {
          const li = document.createElement('li');
          li.textContent = objective;
          lessonObjectivesList.appendChild(li);
        });
      }
      
      // Set content
      lessonContentText.innerHTML = data.content || '';
      
      // Set visuals
      lessonVisualsList.innerHTML = '';
      if (Array.isArray(data.visuals)) {
        data.visuals.forEach(visual => {
          const div = document.createElement('div');
          div.className = 'visual-item';
          div.textContent = visual;
          lessonVisualsList.appendChild(div);
        });
      }
      
      // Set activities
      lessonActivitiesList.innerHTML = '';
      if (Array.isArray(data.activities)) {
        data.activities.forEach(activity => {
          const div = document.createElement('div');
          div.className = 'activity-item';
          div.textContent = activity;
          lessonActivitiesList.appendChild(div);
        });
      }
      
      // Set assessment
      lessonAssessmentList.innerHTML = '';
      if (Array.isArray(data.assessment)) {
        data.assessment.forEach(question => {
          const div = document.createElement('div');
          div.className = 'assessment-item';
          div.textContent = question;
          lessonAssessmentList.appendChild(div);
        });
      }
      
      // Set resources
      lessonResourcesList.innerHTML = '';
      if (Array.isArray(data.additional_resources)) {
        data.additional_resources.forEach(resource => {
          const div = document.createElement('div');
          div.className = 'resource-item';
          div.textContent = resource;
          lessonResourcesList.appendChild(div);
        });
      }
      
      // Show the lesson container
      lessonContainer.style.display = 'block';
    }
    
    /**
     * Print the lesson
     */
    function printLesson() {
      window.print();
    }
    
    /**
     * Save the lesson as PDF
     */
    function saveAsPDF() {
      alert('This feature will allow you to save the lesson as PDF. Currently in development.');
    }
    
    /**
     * Open the customization panel
     */
    function customizeLesson() {
      alert('This feature will allow you to customize the lesson. Currently in development.');
    }
    
    /**
     * Toggle the help panel
     */
    function toggleHelpPanel() {
      helpPanel.classList.toggle('active');
    }
    
    /**
     * Close the help panel
     */
    function closeHelpPanel() {
      helpPanel.classList.remove('active');
    }
    
    /**
     * Handle help option click
     */
    function handleHelpOptionClick(event) {
      const option = event.currentTarget.getAttribute('data-option');
      
      switch (option) {
        case 'what-is':
          helpMessage.textContent = 'Dyslexia-friendly curriculum uses short sentences, bullet points, increased spacing, and visual aids. It breaks complex concepts into smaller steps and includes frequent summaries.';
          break;
        case 'file-types':
          helpMessage.textContent = 'You can upload .txt files (plain text), .doc/.docx (Word documents), or .pdf files. The system will extract the text and convert it to a dyslexia-friendly format.';
          break;
        case 'formats':
          helpMessage.textContent = 'You can choose from text-based formatting (with dyslexia-friendly layout), audio narration scripts, visual guides with diagram descriptions, game-based interactive formats, or adaptive chat-based learning.';
          break;
        default:
          helpMessage.textContent = 'Hi there! I\'m Stella, your learning assistant. Need help converting your curriculum materials to be dyslexia-friendly?';
      }
    }
  </script>
</body>
</html>